<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Online Experiment • mmbruteluck</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Online Experiment">
<meta property="og:description" content="mmbruteluck">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mmbruteluck</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/A-online-experiment.html">Online Experiment</a>
    </li>
    <li>
      <a href="../articles/B-lab-experiment.html">Lab Experiment</a>
    </li>
    <li>
      <a href="../articles/C-bl-mturk-workers.html">mTurk workers</a>
    </li>
    <li>
      <a href="../articles/D-risk-aversion.html">Implied risk aversion of safe alternative</a>
    </li>
    <li>
      <a href="../articles/E-power-analysis-online-experiment.html">Power analysis for the online experiment</a>
    </li>
    <li>
      <a href="../articles/F-AppendixB.html">Appendix B, experimental instructions</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="A-online-experiment_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Online Experiment</h1>
                        <h4 class="author">Alexander W. Cappelen, Sebastian Fest, Erik Ø. Sørensen, and Bertil Tungodden</h4>
            
      
      
      <div class="hidden name"><code>A-online-experiment.Rmd</code></div>

    </div>

    
    
<div id="reading-in-data-" class="section level1">
<h1 class="hasAnchor">
<a href="#reading-in-data-" class="anchor"></a>Reading in data.</h1>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw">treatmentsv</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Base (w)"</span>, <span class="st">"Forced Choice (w)"</span>, <span class="st">"Nominal Choice (w)"</span>, 
                <span class="st">"Base (nw)"</span>, <span class="st">"Forced Choice (nw)"</span>, <span class="st">"Nominal Choice (nw)"</span>,
                <span class="st">"Forced Choice strong"</span>, <span class="st">"Forced Choice very strong"</span>)
<span class="kw">treatmentsv_short</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Base"</span>, <span class="st">"Forced Choice"</span>, <span class="st">"Nominal Choice"</span>)
<span class="kw">df_k</span> <span class="op">&lt;-</span> <span class="kw">bl_kantar</span>  <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span>(treatment_org = <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw">treatment</span>, levels=<span class="kw">treatmentsv</span>),
         treatment = <span class="fu">fct_recode</span>(<span class="kw">treatment_org</span>,
                                <span class="st">"Forced Choice (w)"</span> = <span class="st">"Forced Choice strong"</span>,
                                <span class="st">"Forced Choice (w)"</span> = <span class="st">"Forced Choice very strong"</span>),
         treatment_kantar = <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw">treatment_kantar</span>),
         treatmentgroup = <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw">treatmentgroup</span>, levels=<span class="kw">treatmentsv_short</span>),
         treatmentgroup8 = <span class="fu">fct_recode</span>(<span class="kw">treatment</span>,
                                      <span class="st">"Base"</span> = <span class="st">"Base (w)"</span>,
                                      <span class="st">"Base"</span> = <span class="st">"Base (nw)"</span>,
                                      <span class="st">"Nominal Choice"</span> = <span class="st">"Nominal Choice (w)"</span>,
                                      <span class="st">"Nominal Choice"</span> = <span class="st">"Nominal Choice (nw)"</span>,
                                      <span class="st">"Forced Choice"</span> = <span class="st">"Forced Choice (w)"</span>,
                                      <span class="st">"Forced Choice"</span> = <span class="st">"Forced Choice (nw)"</span>,
                                      <span class="st">"Forced Choice"</span> = <span class="st">"Forced Choice strong"</span>,
                                      <span class="st">"Forced Choice"</span> = <span class="st">"Forced Choice very strong"</span>),
         gender = <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw">gender</span>),
         education = <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw">education</span>),
         indincome = <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw">indincome</span>),
         work_temp = <span class="fu">fct_relevel</span>(<span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="kw">workp</span>), <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"TRUE"</span>, <span class="st">"FALSE"</span>)),
         work = <span class="fu">fct_recode</span>(<span class="kw">work_temp</span>, 
                           <span class="st">"Work"</span> = <span class="st">"TRUE"</span>, 
                           <span class="st">"No Work"</span>= <span class="st">"FALSE"</span>),
         inequality = <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="fl">8</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="kw">y</span>)<span class="op">/</span><span class="fl">8.0</span>,
         zero_to_worst_off = (<span class="kw">y</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">8</span>)),
         university = (<span class="kw">education</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Universitet/hoyskole I"</span>, <span class="st">"Universitet/hoyskole II"</span>)),
         high_income = (<span class="kw">indincome</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"1.000.000 kroner eller mer"</span>, 
                                         <span class="st">"800.000 - 999.999 kroner"</span>,
                                         <span class="st">"700-000 - 799.999 kroner"</span>,
                                         <span class="st">"600.000 - 699.999 kroner"</span>,
                                         <span class="st">"500.000 - 599.999 kroner"</span>)),  <span class="co"># Median is within 400-499 group.</span>
         female = (<span class="kw">gender</span><span class="op">==</span><span class="st">"Kvinne"</span>),
         choice = (<span class="kw">treatmentgroup</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forced Choice"</span>, <span class="st">"Nominal Choice"</span>)),
         age_h = (<span class="kw">age</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="kw">age</span>)),
         crt_h = (<span class="kw">crt</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>,<span class="fl">3</span>)),
         understanding2n = <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span>(<span class="st">"[^0-9]"</span>,<span class="st">""</span>, <span class="kw">understanding2</span>))) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">comp</span><span class="op">==</span><span class="fl">1</span>)
</pre></div>
</div>
<div id="descriptive-figures" class="section level1">
<h1 class="hasAnchor">
<a href="#descriptive-figures" class="anchor"></a>Descriptive figures</h1>
<div id="histogram-of-transfers-to-the-unlucky" class="section level2">
<h2 class="hasAnchor">
<a href="#histogram-of-transfers-to-the-unlucky" class="anchor"></a>Histogram of transfers to the unlucky</h2>
<p>First out is a histogram of the transfer to the unlucky participant. I make it for each of the three main treatments, with and without the work-distinction.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(x=<span class="kw">y</span>, y=<span class="fl">1</span><span class="op">*</span> (<span class="kw">..count..</span>)<span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span>(<span class="kw">..count..</span>,<span class="kw">..PANEL..</span>,<span class="kw">sum</span>)[<span class="kw">..PANEL..</span>])) <span class="op">+</span> 
  <span class="fu">geom_histogram</span>() <span class="op">+</span> <span class="fu">facet_grid</span>(<span class="kw">work</span><span class="op">~</span><span class="kw">treatmentgroup</span>) <span class="op">+</span> <span class="fu">theme_bw</span>() <span class="op">+</span> <span class="fu">ylab</span>(<span class="st">"Fraction"</span>) <span class="op">+</span> 
  <span class="fu">xlab</span>(<span class="st">"Transfer from Lucky to Unlucky"</span>)
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
</pre></div>
<p><img src="A-online-experiment_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="fu">ggsave</span>(<span class="fu">here</span>(<span class="st">"graphs"</span>, <span class="st">"histograms_kantar_wd.pdf"</span>))
<span class="co">#&gt; Saving 7 x 4.5 in image</span>
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
<span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(x=<span class="kw">y</span>, y=<span class="fl">1</span><span class="op">*</span> (<span class="kw">..count..</span>)<span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span>(<span class="kw">..count..</span>,<span class="kw">..PANEL..</span>,<span class="kw">sum</span>)[<span class="kw">..PANEL..</span>])) <span class="op">+</span> 
  <span class="fu">geom_histogram</span>() <span class="op">+</span> <span class="fu">facet_grid</span>(<span class="kw">.</span><span class="op">~</span><span class="kw">treatmentgroup</span>) <span class="op">+</span> <span class="fu">theme_bw</span>() <span class="op">+</span> <span class="fu">ylab</span>(<span class="st">"Fraction"</span>) <span class="op">+</span> 
  <span class="fu">xlab</span>(<span class="st">"Transfer from Lucky to Unlucky"</span>)
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
</pre></div>
<p><img src="A-online-experiment_files/figure-html/unnamed-chunk-4-2.png" width="672"></p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="fu">ggsave</span>(<span class="fu">here</span>(<span class="st">"graphs"</span>, <span class="st">"histograms_kantar.pdf"</span>))
<span class="co">#&gt; Saving 7 x 4.5 in image</span>
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
</pre></div>
<p>Now for a variant, without the weak forced choice (0.25), and only the work conditions:</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="kw">df_k</span> <span class="op">%&gt;%</span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">workp</span><span class="op">==</span><span class="fl">TRUE</span>) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="op">!</span>( <span class="kw">treatment_org</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forced Choice (w)"</span>, <span class="st">"Forced Choice (nw)"</span>))) <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x=<span class="kw">y</span>, y=<span class="fl">1</span><span class="op">*</span> (<span class="kw">..count..</span>)<span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span>(<span class="kw">..count..</span>,<span class="kw">..PANEL..</span>,<span class="kw">sum</span>)[<span class="kw">..PANEL..</span>])) <span class="op">+</span> 
  <span class="fu">geom_histogram</span>() <span class="op">+</span> <span class="fu">facet_grid</span>(<span class="kw">.</span><span class="op">~</span><span class="kw">treatmentgroup</span>) <span class="op">+</span> <span class="fu">theme_bw</span>() <span class="op">+</span> 
  <span class="fu">labs</span>(y = <span class="st">"Fraction"</span>,
       x=<span class="st">"Transfer from Lucky to Unlucky"</span>,
       caption=<span class="st">"Only treatment with work and K\u22640."</span>)
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
</pre></div>
<p><img src="A-online-experiment_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="fu">ggsave</span>(<span class="fu">here</span>(<span class="st">"graphs"</span>, <span class="st">"histograms_kantar_strong.pdf"</span>))
<span class="co">#&gt; Saving 7 x 4.5 in image</span>
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
<span class="co">#&gt; Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;e2&gt;</span>
<span class="co">#&gt; Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;89&gt;</span>
<span class="co">#&gt; Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;a4&gt;</span>
<span class="co">#&gt; Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;e2&gt;</span>
<span class="co">#&gt; Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;89&gt;</span>
<span class="co">#&gt; Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;a4&gt;</span>
<span class="co">#&gt; Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;e2&gt;</span>
<span class="co">#&gt; Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;89&gt;</span>
<span class="co">#&gt; Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;a4&gt;</span>
<span class="co">#&gt; Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;e2&gt;</span>
<span class="co">#&gt; Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;89&gt;</span>
<span class="co">#&gt; Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;a4&gt;</span>
<span class="co">#&gt; Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;e2&gt;</span>
<span class="co">#&gt; Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;89&gt;</span>
<span class="co">#&gt; Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;a4&gt;</span>
<span class="co">#&gt; Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;e2&gt;</span>
<span class="co">#&gt; Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;89&gt;</span>
<span class="co">#&gt; Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;a4&gt;</span>
<span class="co">#&gt; Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;e2&gt;</span>
<span class="co">#&gt; Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;89&gt;</span>
<span class="co">#&gt; Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;a4&gt;</span>
<span class="co">#&gt; Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;e2&gt;</span>
<span class="co">#&gt; Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;89&gt;</span>
<span class="co">#&gt; Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;a4&gt;</span>
<span class="co">#&gt; Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;e2&gt;</span>
<span class="co">#&gt; Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;89&gt;</span>
<span class="co">#&gt; Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :</span>
<span class="co">#&gt; conversion failure on 'Only treatment with work and K≤0.' in 'mbcsToSbcs': dot</span>
<span class="co">#&gt; substituted for &lt;a4&gt;</span>
</pre></div>
<p>It is interesting to also look at how the histograms are similar also for all the different treatment variations, not only for the pooled groups:</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(x=<span class="kw">y</span>, y=<span class="fl">1</span><span class="op">*</span> (<span class="kw">..count..</span>)<span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span>(<span class="kw">..count..</span>,<span class="kw">..PANEL..</span>,<span class="kw">sum</span>)[<span class="kw">..PANEL..</span>])) <span class="op">+</span> 
  <span class="fu">geom_histogram</span>() <span class="op">+</span> <span class="fu">facet_wrap</span>(<span class="kw">.</span><span class="op">~</span><span class="kw">treatment_org</span>) <span class="op">+</span> <span class="fu">theme_bw</span>() <span class="op">+</span> <span class="fu">ylab</span>(<span class="st">"Fraction"</span>) <span class="op">+</span> 
  <span class="fu">xlab</span>(<span class="st">"Transfer from Lucky to Unlucky"</span>)
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
</pre></div>
<p><img src="A-online-experiment_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="fu">ggsave</span>(<span class="fu">here</span>(<span class="st">"graphs"</span>, <span class="st">"histograms_kantar_8.pdf"</span>))
<span class="co">#&gt; Saving 7 x 4.5 in image</span>
<span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span>
</pre></div>
<div id="the-share-that-equalizes" class="section level3">
<h3 class="hasAnchor">
<a href="#the-share-that-equalizes" class="anchor"></a>The share that equalizes</h3>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="kw">df_equal</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span>(equal = (<span class="kw">y</span><span class="op">==</span><span class="fl">4</span>)) 
<span class="kw">df_equal</span> <span class="op">%&gt;%</span> 
  <span class="fu">group_by</span>(<span class="kw">treatmentgroup</span>) <span class="op">%&gt;%</span> 
  <span class="fu">summarize</span>(share_equal=<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw">equal</span>)) <span class="op">%&gt;%</span>
  <span class="kw">knitr</span>::<span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(digits=<span class="fl">3</span>)
<span class="co">#&gt; `summarise()` ungrouping output (override with `.groups` argument)</span>
</pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">treatmentgroup</th>
<th align="right">share_equal</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Base</td>
<td align="right">0.738</td>
</tr>
<tr class="even">
<td align="left">Forced Choice</td>
<td align="right">0.562</td>
</tr>
<tr class="odd">
<td align="left">Nominal Choice</td>
<td align="right">0.573</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="kw">ce</span> <span class="op">&lt;-</span> <span class="kw">df_equal</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="kw">treatmentgroup</span>) <span class="op">%&gt;%</span> <span class="fu">summarize</span>( yc = <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">y</span><span class="op">==</span><span class="fl">4</span>), n=<span class="fu">n</span>())
<span class="co">#&gt; `summarise()` ungrouping output (override with `.groups` argument)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span>(<span class="kw">ce</span><span class="op">$</span><span class="kw">yc</span>[<span class="kw">ce</span><span class="op">$</span><span class="kw">treatmentgroup</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Base"</span>, <span class="st">"Nominal Choice"</span>) ], 
          <span class="kw">ce</span><span class="op">$</span><span class="kw">n</span>[<span class="kw">ce</span><span class="op">$</span><span class="kw">treatmentgroup</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Base"</span>, <span class="st">"Nominal Choice"</span>) ])
<span class="co">#&gt; </span>
<span class="co">#&gt;  2-sample test for equality of proportions with continuity correction</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  ce$yc[ce$treatmentgroup %in% c("Base", "Nominal Choice")] out of ce$n[ce$treatmentgroup %in% c("Base", "Nominal Choice")]</span>
<span class="co">#&gt; X-squared = 87.167, df = 1, p-value &lt; 2.2e-16</span>
<span class="co">#&gt; alternative hypothesis: two.sided</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  0.1307957 0.2004107</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;    prop 1    prop 2 </span>
<span class="co">#&gt; 0.7383242 0.5727209</span>
<span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span>(<span class="kw">ce</span><span class="op">$</span><span class="kw">yc</span>[<span class="kw">ce</span><span class="op">$</span><span class="kw">treatmentgroup</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Base"</span>, <span class="st">"Forced Choice"</span>) ], 
                    <span class="kw">ce</span><span class="op">$</span><span class="kw">n</span>[<span class="kw">ce</span><span class="op">$</span><span class="kw">treatmentgroup</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Base"</span>, <span class="st">"Forced Choice"</span>) ])
<span class="co">#&gt; </span>
<span class="co">#&gt;  2-sample test for equality of proportions with continuity correction</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  ce$yc[ce$treatmentgroup %in% c("Base", "Forced Choice")] out of ce$n[ce$treatmentgroup %in% c("Base", "Forced Choice")]</span>
<span class="co">#&gt; X-squared = 126.14, df = 1, p-value &lt; 2.2e-16</span>
<span class="co">#&gt; alternative hypothesis: two.sided</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  0.1463265 0.2053218</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;    prop 1    prop 2 </span>
<span class="co">#&gt; 0.7383242 0.5625000</span>
<span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span>(<span class="kw">ce</span><span class="op">$</span><span class="kw">yc</span>[<span class="kw">ce</span><span class="op">$</span><span class="kw">treatmentgroup</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Nominal Choice"</span>, <span class="st">"Forced Choice"</span>) ], 
          <span class="kw">ce</span><span class="op">$</span><span class="kw">n</span>[<span class="kw">ce</span><span class="op">$</span><span class="kw">treatmentgroup</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Nominal Choice"</span>, <span class="st">"Forced Choice"</span>) ])
<span class="co">#&gt; </span>
<span class="co">#&gt;  2-sample test for equality of proportions with continuity correction</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  ce$yc[ce$treatmentgroup %in% c("Nominal Choice", "Forced Choice")] out of ce$n[ce$treatmentgroup %in% c("Nominal Choice", "Forced Choice")]</span>
<span class="co">#&gt; X-squared = 0.36638, df = 1, p-value = 0.545</span>
<span class="co">#&gt; alternative hypothesis: two.sided</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -0.04211637  0.02167448</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;    prop 1    prop 2 </span>
<span class="co">#&gt; 0.5625000 0.5727209</span>
</pre></div>
</div>
<div id="the-share-that-gives-nothing-to-unlucky" class="section level3">
<h3 class="hasAnchor">
<a href="#the-share-that-gives-nothing-to-unlucky" class="anchor"></a>The share that gives nothing to unlucky</h3>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="kw">df_0</span>  <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span>(nothing = (<span class="kw">y</span><span class="op">==</span><span class="fl">0</span>)) 
<span class="kw">df_0</span> <span class="op">%&gt;%</span> 
  <span class="fu">group_by</span>(<span class="kw">treatmentgroup</span>) <span class="op">%&gt;%</span> 
  <span class="fu">summarize</span>(share_equal=<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw">nothing</span>)) <span class="op">%&gt;%</span>
  <span class="kw">knitr</span>::<span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(digits=<span class="fl">3</span>)
<span class="co">#&gt; `summarise()` ungrouping output (override with `.groups` argument)</span>
</pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">treatmentgroup</th>
<th align="right">share_equal</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Base</td>
<td align="right">0.073</td>
</tr>
<tr class="even">
<td align="left">Forced Choice</td>
<td align="right">0.186</td>
</tr>
<tr class="odd">
<td align="left">Nominal Choice</td>
<td align="right">0.134</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="kw">c0</span> <span class="op">&lt;-</span> <span class="kw">df_0</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="kw">treatmentgroup</span>) <span class="op">%&gt;%</span> <span class="fu">summarize</span>( y0= <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">y</span><span class="op">==</span><span class="fl">0</span>), n=<span class="fu">n</span>())
<span class="co">#&gt; `summarise()` ungrouping output (override with `.groups` argument)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span>(<span class="kw">c0</span><span class="op">$</span><span class="kw">y0</span>[<span class="kw">c0</span><span class="op">$</span><span class="kw">treatmentgroup</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Base"</span>, <span class="st">"Nominal Choice"</span>) ], 
          <span class="kw">c0</span><span class="op">$</span><span class="kw">n</span>[<span class="kw">c0</span><span class="op">$</span><span class="kw">treatmentgroup</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Base"</span>, <span class="st">"Nominal Choice"</span>) ])
<span class="co">#&gt; </span>
<span class="co">#&gt;  2-sample test for equality of proportions with continuity correction</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  c0$y0[c0$treatmentgroup %in% c("Base", "Nominal Choice")] out of c0$n[c0$treatmentgroup %in% c("Base", "Nominal Choice")]</span>
<span class="co">#&gt; X-squared = 28.289, df = 1, p-value = 1.045e-07</span>
<span class="co">#&gt; alternative hypothesis: two.sided</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -0.08358136 -0.03803762</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;    prop 1    prop 2 </span>
<span class="co">#&gt; 0.0728022 0.1336117</span>
<span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span>(<span class="kw">c0</span><span class="op">$</span><span class="kw">y0</span>[<span class="kw">c0</span><span class="op">$</span><span class="kw">treatmentgroup</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Base"</span>, <span class="st">"Forced Choice"</span>) ], 
          <span class="kw">c0</span><span class="op">$</span><span class="kw">n</span>[<span class="kw">c0</span><span class="op">$</span><span class="kw">treatmentgroup</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Base"</span>, <span class="st">"Forced Choice"</span>) ])
<span class="co">#&gt; </span>
<span class="co">#&gt;  2-sample test for equality of proportions with continuity correction</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  c0$y0[c0$treatmentgroup %in% c("Base", "Forced Choice")] out of c0$n[c0$treatmentgroup %in% c("Base", "Forced Choice")]</span>
<span class="co">#&gt; X-squared = 96.941, df = 1, p-value &lt; 2.2e-16</span>
<span class="co">#&gt; alternative hypothesis: two.sided</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -0.13298830 -0.09291569</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;    prop 1    prop 2 </span>
<span class="co">#&gt; 0.0728022 0.1857542</span>
<span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span>(<span class="kw">c0</span><span class="op">$</span><span class="kw">y0</span>[<span class="kw">c0</span><span class="op">$</span><span class="kw">treatmentgroup</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Nominal Choice"</span>, <span class="st">"Forced Choice"</span>) ], 
          <span class="kw">c0</span><span class="op">$</span><span class="kw">n</span>[<span class="kw">c0</span><span class="op">$</span><span class="kw">treatmentgroup</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Nominal Choice"</span>, <span class="st">"Forced Choice"</span>) ])
<span class="co">#&gt; </span>
<span class="co">#&gt;  2-sample test for equality of proportions with continuity correction</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  c0$y0[c0$treatmentgroup %in% c("Nominal Choice", "Forced Choice")] out of c0$n[c0$treatmentgroup %in% c("Nominal Choice", "Forced Choice")]</span>
<span class="co">#&gt; X-squared = 18.213, df = 1, p-value = 1.975e-05</span>
<span class="co">#&gt; alternative hypothesis: two.sided</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  0.0289854 0.0752996</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;    prop 1    prop 2 </span>
<span class="co">#&gt; 0.1857542 0.1336117</span>
</pre></div>
</div>
</div>
<div id="mean-inequality" class="section level2">
<h2 class="hasAnchor">
<a href="#mean-inequality" class="anchor"></a>Mean inequality</h2>
<p>The next descriptive figure is a bargraph showing the amount of inequality by treatment and work status.</p>
<p>First with work distinction:</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="kw">df_mean_ineq_nothing_kantar_wd</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> 
  <span class="kw">dplyr</span>::<span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="kw">treatmentgroup</span>, <span class="kw">work</span>, <span class="kw">inequality</span>, <span class="kw">zero_to_worst_off</span>) <span class="op">%&gt;%</span>
  <span class="fu">gather</span>(<span class="kw">inequality</span>, <span class="kw">zero_to_worst_off</span>, key=<span class="st">"outcome"</span>, value=<span class="st">"y"</span>) <span class="op">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="kw">treatmentgroup</span>, <span class="kw">work</span>, <span class="kw">outcome</span>) <span class="op">%&gt;%</span>
  <span class="fu">summarize</span>(mean_y = <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw">y</span>, na.rm=<span class="fl">TRUE</span>), se_y = <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="kw">y</span>, na.rm=<span class="fl">TRUE</span>)<span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu">n</span>())) <span class="op">%&gt;%</span>
  <span class="fu">mutate</span>(outcome = <span class="fu">fct_recode</span>(<span class="kw">outcome</span>, 
                              <span class="st">"Inequality"</span> = <span class="st">"inequality"</span>,
                              <span class="st">"Nothing to worse off"</span> = <span class="st">"zero_to_worst_off"</span>))
<span class="co">#&gt; `summarise()` regrouping output by 'treatmentgroup', 'work' (override with `.groups` argument)</span>
<span class="kw">df_mean_ineq_nothing_kantar_wd</span>
<span class="co">#&gt; # A tibble: 12 x 5</span>
<span class="co">#&gt; # Groups:   treatmentgroup, work [6]</span>
<span class="co">#&gt;    treatmentgroup work    outcome              mean_y    se_y</span>
<span class="co">#&gt;    &lt;fct&gt;          &lt;fct&gt;   &lt;fct&gt;                 &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt;  1 Base           Work    Inequality           0.134  0.0104 </span>
<span class="co">#&gt;  2 Base           Work    Nothing to worse off 0.0644 0.00900</span>
<span class="co">#&gt;  3 Base           No Work Inequality           0.199  0.0129 </span>
<span class="co">#&gt;  4 Base           No Work Nothing to worse off 0.104  0.0115 </span>
<span class="co">#&gt;  5 Forced Choice  Work    Inequality           0.299  0.00859</span>
<span class="co">#&gt;  6 Forced Choice  Work    Nothing to worse off 0.179  0.00833</span>
<span class="co">#&gt;  7 Forced Choice  No Work Inequality           0.368  0.0158 </span>
<span class="co">#&gt;  8 Forced Choice  No Work Nothing to worse off 0.259  0.0161 </span>
<span class="co">#&gt;  9 Nominal Choice Work    Inequality           0.242  0.0133 </span>
<span class="co">#&gt; 10 Nominal Choice Work    Nothing to worse off 0.129  0.0126 </span>
<span class="co">#&gt; 11 Nominal Choice No Work Inequality           0.310  0.0143 </span>
<span class="co">#&gt; 12 Nominal Choice No Work Nothing to worse off 0.173  0.0141</span>
<span class="kw">df_mean_ineq_nothing_kantar_wd</span> <span class="op">%&gt;%</span>
<span class="fu">ggplot</span>(<span class="fu">aes</span>(x=<span class="kw">treatmentgroup</span>, y=<span class="kw">mean_y</span>)) <span class="op">+</span> <span class="fu">geom_bar</span>(stat=<span class="st">"identity"</span>, width=<span class="fl">0.7</span>) <span class="op">+</span>
  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(ymax=<span class="kw">mean_y</span><span class="op">+</span><span class="kw">se_y</span>, ymin=<span class="kw">mean_y</span> <span class="op">-</span> <span class="kw">se_y</span>), width=<span class="fl">0.2</span>) <span class="op">+</span> 
  <span class="fu">facet_grid</span>(<span class="kw">work</span> <span class="op">~</span> <span class="kw">outcome</span>) <span class="op">+</span> <span class="fu">xlab</span>(<span class="st">""</span>) <span class="op">+</span> <span class="fu">ylab</span>(<span class="st">"Mean \u00B1 s.e.m."</span>) <span class="op">+</span>
  <span class="fu">theme_bw</span>()
</pre></div>
<p><img src="A-online-experiment_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="fu">ggsave</span>(<span class="fu">here</span>(<span class="st">"graphs"</span>, <span class="st">"mean_ineq_nothing_kantar_wd.pdf"</span>))
<span class="co">#&gt; Saving 7 x 4.5 in image</span>
</pre></div>
<p>Similarly, without the work distinction for the main short paper.</p>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="kw">df_mean_ineq_nothing_kantar</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> 
  <span class="kw">dplyr</span>::<span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="kw">treatmentgroup</span>, <span class="kw">inequality</span>, <span class="kw">zero_to_worst_off</span>) <span class="op">%&gt;%</span>
  <span class="fu">gather</span>(<span class="kw">inequality</span>, <span class="kw">zero_to_worst_off</span>, key=<span class="st">"outcome"</span>, value=<span class="st">"y"</span>) <span class="op">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="kw">treatmentgroup</span>, <span class="kw">outcome</span>) <span class="op">%&gt;%</span>
  <span class="fu">summarize</span>(mean_y = <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw">y</span>, na.rm=<span class="fl">TRUE</span>), se_y = <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="kw">y</span>, na.rm=<span class="fl">TRUE</span>)<span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu">n</span>())) <span class="op">%&gt;%</span>
  <span class="fu">mutate</span>(outcome = <span class="fu">fct_recode</span>(<span class="kw">outcome</span>, 
                              <span class="st">"Inequality"</span> = <span class="st">"inequality"</span>,
                              <span class="st">"Nothing to worse off"</span> = <span class="st">"zero_to_worst_off"</span>))
<span class="co">#&gt; `summarise()` regrouping output by 'treatmentgroup' (override with `.groups` argument)</span>
<span class="kw">df_mean_ineq_nothing_kantar</span>
<span class="co">#&gt; # A tibble: 6 x 4</span>
<span class="co">#&gt; # Groups:   treatmentgroup [3]</span>
<span class="co">#&gt;   treatmentgroup outcome              mean_y    se_y</span>
<span class="co">#&gt;   &lt;fct&gt;          &lt;fct&gt;                 &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Base           Inequality           0.166  0.00829</span>
<span class="co">#&gt; 2 Base           Nothing to worse off 0.0838 0.00726</span>
<span class="co">#&gt; 3 Forced Choice  Inequality           0.317  0.00759</span>
<span class="co">#&gt; 4 Forced Choice  Nothing to worse off 0.200  0.00748</span>
<span class="co">#&gt; 5 Nominal Choice Inequality           0.276  0.00980</span>
<span class="co">#&gt; 6 Nominal Choice Nothing to worse off 0.151  0.00945</span>
<span class="kw">df_mean_ineq_nothing_kantar</span> <span class="op">%&gt;%</span>
<span class="fu">ggplot</span>(<span class="fu">aes</span>(x=<span class="kw">treatmentgroup</span>, y=<span class="kw">mean_y</span>)) <span class="op">+</span> <span class="fu">geom_bar</span>(stat=<span class="st">"identity"</span>, width=<span class="fl">0.7</span>) <span class="op">+</span>
  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(ymax=<span class="kw">mean_y</span><span class="op">+</span><span class="kw">se_y</span>, ymin=<span class="kw">mean_y</span> <span class="op">-</span> <span class="kw">se_y</span>), width=<span class="fl">0.2</span>) <span class="op">+</span> 
  <span class="fu">facet_grid</span>(<span class="kw">.</span> <span class="op">~</span> <span class="kw">outcome</span>) <span class="op">+</span> <span class="fu">xlab</span>(<span class="st">""</span>) <span class="op">+</span> <span class="fu">ylab</span>(<span class="st">"Mean \u00B1 s.e.m."</span>) <span class="op">+</span>
  <span class="fu">theme_bw</span>()
</pre></div>
<p><img src="A-online-experiment_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="fu">ggsave</span>(<span class="fu">here</span>(<span class="st">"graphs"</span>, <span class="st">"mean_ineq_nothing_kantar.pdf"</span>))
<span class="co">#&gt; Saving 7 x 4.5 in image</span>
</pre></div>
<p>The same, but variant with Forced Choice (<span class="math inline">\(K\leq0\)</span>) and only the work conditions:</p>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="kw">df_mean_ineq_nothing_kantar_wstrong</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="op">!</span>( <span class="kw">treatment_org</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forced Choice (w)"</span>, <span class="st">"Forced Choice (nw)"</span>))) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">workp</span><span class="op">==</span><span class="fl">TRUE</span>) <span class="op">%&gt;%</span>
  <span class="kw">dplyr</span>::<span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="kw">treatmentgroup</span>, <span class="kw">inequality</span>, <span class="kw">zero_to_worst_off</span>) <span class="op">%&gt;%</span>
  <span class="fu">gather</span>(<span class="kw">inequality</span>, <span class="kw">zero_to_worst_off</span>, key=<span class="st">"outcome"</span>, value=<span class="st">"y"</span>) <span class="op">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="kw">treatmentgroup</span>, <span class="kw">outcome</span>) <span class="op">%&gt;%</span>
  <span class="fu">summarize</span>(mean_y = <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw">y</span>, na.rm=<span class="fl">TRUE</span>), se_y = <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="kw">y</span>, na.rm=<span class="fl">TRUE</span>)<span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu">n</span>())) <span class="op">%&gt;%</span>
  <span class="fu">mutate</span>(outcome = <span class="fu">fct_recode</span>(<span class="kw">outcome</span>, 
                              <span class="st">"Inequality"</span> = <span class="st">"inequality"</span>,
                              <span class="st">"Nothing to worse off"</span> = <span class="st">"zero_to_worst_off"</span>))
<span class="co">#&gt; `summarise()` regrouping output by 'treatmentgroup' (override with `.groups` argument)</span>
<span class="kw">df_mean_ineq_nothing_kantar_wstrong</span>
<span class="co">#&gt; # A tibble: 6 x 4</span>
<span class="co">#&gt; # Groups:   treatmentgroup [3]</span>
<span class="co">#&gt;   treatmentgroup outcome              mean_y    se_y</span>
<span class="co">#&gt;   &lt;fct&gt;          &lt;fct&gt;                 &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Base           Inequality           0.134  0.0104 </span>
<span class="co">#&gt; 2 Base           Nothing to worse off 0.0644 0.00900</span>
<span class="co">#&gt; 3 Forced Choice  Inequality           0.295  0.0104 </span>
<span class="co">#&gt; 4 Forced Choice  Nothing to worse off 0.179  0.0102 </span>
<span class="co">#&gt; 5 Nominal Choice Inequality           0.242  0.0133 </span>
<span class="co">#&gt; 6 Nominal Choice Nothing to worse off 0.129  0.0126</span>
<span class="kw">df_mean_ineq_nothing_kantar_wstrong</span> <span class="op">%&gt;%</span>
<span class="fu">ggplot</span>(<span class="fu">aes</span>(x=<span class="kw">treatmentgroup</span>, y=<span class="kw">mean_y</span>)) <span class="op">+</span> <span class="fu">geom_bar</span>(stat=<span class="st">"identity"</span>, width=<span class="fl">0.7</span>) <span class="op">+</span>
  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(ymax=<span class="kw">mean_y</span><span class="op">+</span><span class="kw">se_y</span>, ymin=<span class="kw">mean_y</span> <span class="op">-</span> <span class="kw">se_y</span>), width=<span class="fl">0.2</span>) <span class="op">+</span> 
  <span class="fu">facet_grid</span>(<span class="kw">.</span> <span class="op">~</span> <span class="kw">outcome</span>) <span class="op">+</span> 
  <span class="fu">labs</span>(x = <span class="fu">element_blank</span>(),
       y = <span class="st">"Mean \u00B1 s.e.m."</span>,
       caption=<span class="st">"Only treatment with work and K\u22640."</span>) <span class="op">+</span>
  <span class="fu">theme_bw</span>()
</pre></div>
<p><img src="A-online-experiment_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<div class="sourceCode" id="cb18"><pre class="downlit">
<span class="fu">ggsave</span>(<span class="fu">here</span>(<span class="st">"graphs"</span>, <span class="st">"mean_ineq_nothing_kantar_wstrong.pdf"</span>), device=<span class="kw">cairo_pdf</span>)
<span class="co">#&gt; Saving 7 x 4.5 in image</span>
</pre></div>
<div id="testing-against-base-treatment" class="section level3">
<h3 class="hasAnchor">
<a href="#testing-against-base-treatment" class="anchor"></a>Testing against Base treatment</h3>
<p>For mean inequality:</p>
<div class="sourceCode" id="cb19"><pre class="downlit">
<span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">treatmentgroup</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forced Choice"</span>, <span class="st">"Base"</span>)) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">treatmentgroup</span>, data=<span class="kw">.</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Welch Two Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  inequality by treatmentgroup</span>
<span class="co">#&gt; t = -13.43, df = 3623.3, p-value &lt; 2.2e-16</span>
<span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -0.1729084 -0.1288535</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;          mean in group Base mean in group Forced Choice </span>
<span class="co">#&gt;                   0.1661058                   0.3169867</span>
<span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">treatmentgroup</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Nominal Choice"</span>, <span class="st">"Base"</span>)) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">treatmentgroup</span>, data=<span class="kw">.</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Welch Two Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  inequality by treatmentgroup</span>
<span class="co">#&gt; t = -8.5753, df = 2806.8, p-value &lt; 2.2e-16</span>
<span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -0.13524719 -0.08490731</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;           mean in group Base mean in group Nominal Choice </span>
<span class="co">#&gt;                    0.1661058                    0.2761830</span>
</pre></div>
</div>
<div id="testing-forced-vs-nominal" class="section level3">
<h3 class="hasAnchor">
<a href="#testing-forced-vs-nominal" class="anchor"></a>Testing Forced vs Nominal</h3>
<p>First, for mean inequality:</p>
<div class="sourceCode" id="cb20"><pre class="downlit">
<span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">treatmentgroup</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forced Choice"</span>, <span class="st">"Nominal Choice"</span>)) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">treatmentgroup</span>, data=<span class="kw">.</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Welch Two Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  inequality by treatmentgroup</span>
<span class="co">#&gt; t = 3.2914, df = 3111.4, p-value = 0.001008</span>
<span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  0.01649665 0.06511078</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;  mean in group Forced Choice mean in group Nominal Choice </span>
<span class="co">#&gt;                    0.3169867                    0.2761830</span>
</pre></div>
<p>Second, for giving nothing to the worst off</p>
<div class="sourceCode" id="cb21"><pre class="downlit">
<span class="kw">nothingtw</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span>  <span class="fu">group_by</span>(<span class="kw">treatmentgroup</span>) <span class="op">%&gt;%</span> 
  <span class="fu">summarize</span>( nothing = <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">inequality</span> <span class="op">==</span> <span class="fl">1</span>), n=<span class="fu">n</span>())
<span class="co">#&gt; `summarise()` ungrouping output (override with `.groups` argument)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span>(<span class="kw">nothingtw</span><span class="op">$</span><span class="kw">nothing</span>[<span class="kw">nothingtw</span><span class="op">$</span><span class="kw">treatmentgroup</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forced Choice"</span>, <span class="st">"Nominal Choice"</span>) ], 
          <span class="kw">nothingtw</span><span class="op">$</span><span class="kw">n</span>[<span class="kw">nothingtw</span><span class="op">$</span><span class="kw">treatmentgroup</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forced Choice"</span>, <span class="st">"Nominal Choice"</span>) ])
<span class="co">#&gt; </span>
<span class="co">#&gt;  2-sample test for equality of proportions with continuity correction</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  nothingtw$nothing[nothingtw$treatmentgroup %in% c("Forced Choice", "Nominal Choice")] out of nothingtw$n[nothingtw$treatmentgroup %in% c("Forced Choice", "Nominal Choice")]</span>
<span class="co">#&gt; X-squared = 15.035, df = 1, p-value = 0.0001055</span>
<span class="co">#&gt; alternative hypothesis: two.sided</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  0.02492920 0.07319237</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;    prop 1    prop 2 </span>
<span class="co">#&gt; 0.2000698 0.1510090</span>
<span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span>(<span class="kw">nothingtw</span><span class="op">$</span><span class="kw">nothing</span>[<span class="kw">nothingtw</span><span class="op">$</span><span class="kw">treatmentgroup</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Base"</span>, <span class="st">"Nominal Choice"</span>) ], 
          <span class="kw">nothingtw</span><span class="op">$</span><span class="kw">n</span>[<span class="kw">nothingtw</span><span class="op">$</span><span class="kw">treatmentgroup</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Base"</span>, <span class="st">"Nominal Choice"</span>) ])
<span class="co">#&gt; </span>
<span class="co">#&gt;  2-sample test for equality of proportions with continuity correction</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  nothingtw$nothing[nothingtw$treatmentgroup %in% c("Base", "Nominal Choice")] out of nothingtw$n[nothingtw$treatmentgroup %in% c("Base", "Nominal Choice")]</span>
<span class="co">#&gt; X-squared = 30.941, df = 1, p-value = 2.66e-08</span>
<span class="co">#&gt; alternative hypothesis: two.sided</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -0.09126026 -0.04317541</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;     prop 1     prop 2 </span>
<span class="co">#&gt; 0.08379121 0.15100905</span>
<span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span>(<span class="kw">nothingtw</span><span class="op">$</span><span class="kw">nothing</span>[<span class="kw">nothingtw</span><span class="op">$</span><span class="kw">treatmentgroup</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forced Choice"</span>, <span class="st">"Base"</span>) ], 
          <span class="kw">nothingtw</span><span class="op">$</span><span class="kw">n</span>[<span class="kw">nothingtw</span><span class="op">$</span><span class="kw">treatmentgroup</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forced Choice"</span>, <span class="st">"Base"</span>) ])
<span class="co">#&gt; </span>
<span class="co">#&gt;  2-sample test for equality of proportions with continuity correction</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  nothingtw$nothing[nothingtw$treatmentgroup %in% c("Forced Choice", "Base")] out of nothingtw$n[nothingtw$treatmentgroup %in% c("Forced Choice", "Base")]</span>
<span class="co">#&gt; X-squared = 95.818, df = 1, p-value &lt; 2.2e-16</span>
<span class="co">#&gt; alternative hypothesis: two.sided</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -0.1372223 -0.0953349</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;     prop 1     prop 2 </span>
<span class="co">#&gt; 0.08379121 0.20006983</span>
</pre></div>
</div>
</div>
</div>
<div id="robustness-for-the-forced-alternative" class="section level1">
<h1 class="hasAnchor">
<a href="#robustness-for-the-forced-alternative" class="anchor"></a>Robustness for the “forced” alternative</h1>
<p>We did two variations of the “Forced Choice” treatment. One “strong” in which the alternative to the lottery was 0 cent with certainty, and one in which they actually had to pay 0.25 to avoid the lottery (I call it very-strong). Both these variants were with work. To look at the effect of this, I graph the level of inequality of the three forced choice treatments (with work) with the comparison to the base treatment (with work).</p>
<div class="sourceCode" id="cb22"><pre class="downlit">
<span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">treatment_org</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Base (w)"</span>, 
                                 <span class="st">"Forced Choice (w)"</span>, 
                                 <span class="st">"Forced Choice strong"</span>,
                                 <span class="st">"Forced Choice very strong"</span>)) <span class="op">%&gt;%</span>
  <span class="kw">dplyr</span>::<span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="kw">treatment_org</span>, <span class="kw">inequality</span>, <span class="kw">zero_to_worst_off</span>) <span class="op">%&gt;%</span>
  <span class="fu">gather</span>(<span class="kw">inequality</span>, <span class="kw">zero_to_worst_off</span>, key=<span class="st">"outcome"</span>, value=<span class="st">"y"</span>) <span class="op">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="kw">treatment_org</span>, <span class="kw">outcome</span>) <span class="op">%&gt;%</span>
  <span class="fu">summarize</span>(mean_y = <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw">y</span>, na.rm=<span class="fl">TRUE</span>), se_y = <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="kw">y</span>, na.rm=<span class="fl">TRUE</span>)<span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu">n</span>())) <span class="op">%&gt;%</span>
  <span class="fu">mutate</span>(outcome = <span class="fu">fct_recode</span>(<span class="kw">outcome</span>, 
                              <span class="st">"Inequality"</span> = <span class="st">"inequality"</span>,
                              <span class="st">"Nothing to worse off"</span> = <span class="st">"zero_to_worst_off"</span>)) <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x=<span class="kw">treatment_org</span>, y=<span class="kw">mean_y</span>)) <span class="op">+</span> <span class="fu">geom_bar</span>(stat=<span class="st">"identity"</span>, width=<span class="fl">0.7</span>) <span class="op">+</span>
    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(ymax=<span class="kw">mean_y</span><span class="op">+</span><span class="kw">se_y</span>, ymin=<span class="kw">mean_y</span> <span class="op">-</span> <span class="kw">se_y</span>), width=<span class="fl">0.2</span>) <span class="op">+</span> 
    <span class="fu">facet_wrap</span>(<span class="op">~</span> <span class="kw">outcome</span>) <span class="op">+</span> <span class="fu">xlab</span>(<span class="st">""</span>) <span class="op">+</span> <span class="fu">ylab</span>(<span class="st">"Mean \u00B1 s.e.m."</span>) <span class="op">+</span>
    <span class="fu">theme_bw</span>() <span class="op">+</span> <span class="fu">scale_x_discrete</span>(labels=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Base (w)"</span>,
                                           <span class="st">"Forced\nChoice (w)"</span>, 
                                           <span class="st">"Forced\nChoice\nstrong"</span>,
                                           <span class="st">"Forced\nChoice\nvery strong"</span>))
<span class="co">#&gt; `summarise()` regrouping output by 'treatment_org' (override with `.groups` argument)</span>
</pre></div>
<p><img src="A-online-experiment_files/figure-html/unnamed-chunk-17-1.png" width="672"></p>
<div class="sourceCode" id="cb23"><pre class="downlit">
<span class="fu">ggsave</span>(<span class="fu">here</span>(<span class="st">"graphs"</span>, <span class="st">"mean_ineq_nothing_robust_kantar.pdf"</span>))
<span class="co">#&gt; Saving 7 x 4.5 in image</span>
</pre></div>
<p>Are the differences between the forced treatments significant? First a test of mean implemented inequality being the same in all forced (work) treatments:</p>
<div class="sourceCode" id="cb24"><pre class="downlit">
<span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">treatment_org</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forced Choice (w)"</span>, 
                                 <span class="st">"Forced Choice strong"</span>,
                                 <span class="st">"Forced Choice very strong"</span>)) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/oneway.test.html">oneway.test</a></span>( <span class="kw">inequality</span> <span class="op">~</span> <span class="kw">treatment_org</span>, data=<span class="kw">.</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  One-way analysis of means (not assuming equal variances)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  inequality and treatment_org</span>
<span class="co">#&gt; F = 6.9709, num df = 2.0, denom df = 1409.9, p-value = 0.0009715</span>
</pre></div>
<p>Increases in implemented inequality compared to base treatment (for the forced choice variants).</p>
<div class="sourceCode" id="cb25"><pre class="downlit">
<span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">treatment_org</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Base (w)"</span>, 
                                 <span class="st">"Forced Choice strong"</span>)) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span>( <span class="kw">inequality</span> <span class="op">~</span> <span class="kw">treatment_org</span>, data=<span class="kw">.</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Welch Two Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  inequality by treatment_org</span>
<span class="co">#&gt; t = -7.0516, df = 1335.4, p-value = 2.83e-12</span>
<span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -0.15782165 -0.08912204</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;             mean in group Base (w) mean in group Forced Choice strong </span>
<span class="co">#&gt;                          0.1343624                          0.2578343</span>
<span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">treatment_org</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Base (w)"</span>, 
                                 <span class="st">"Forced Choice very strong"</span>)) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span>( <span class="kw">inequality</span> <span class="op">~</span> <span class="kw">treatment_org</span>, data=<span class="kw">.</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Welch Two Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  inequality by treatment_org</span>
<span class="co">#&gt; t = -10.755, df = 1250.6, p-value &lt; 2.2e-16</span>
<span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -0.2359653 -0.1631619</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;                  mean in group Base (w) mean in group Forced Choice very strong </span>
<span class="co">#&gt;                               0.1343624                               0.3339260</span>
</pre></div>
<p>Now, the same test for the proportion implementing the nothing to the worst off:</p>
<div class="sourceCode" id="cb26"><pre class="downlit">
<span class="kw">uz</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">treatment_org</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Forced Choice (w)"</span>, 
                                 <span class="st">"Forced Choice strong"</span>,
                                 <span class="st">"Forced Choice very strong"</span>)) <span class="op">%&gt;%</span> 
  <span class="fu">group_by</span>(<span class="kw">treatment_org</span>) <span class="op">%&gt;%</span> 
  <span class="fu">summarize</span>(tw0 = <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">inequality</span><span class="op">==</span><span class="fl">1</span>),  n=<span class="fu">n</span>()) 
<span class="co">#&gt; `summarise()` ungrouping output (override with `.groups` argument)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span>(<span class="kw">uz</span><span class="op">$</span><span class="kw">tw0</span>, <span class="kw">uz</span><span class="op">$</span><span class="kw">n</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  3-sample test for equality of proportions without continuity</span>
<span class="co">#&gt;  correction</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  uz$tw0 out of uz$n</span>
<span class="co">#&gt; X-squared = 7.9248, df = 2, p-value = 0.01902</span>
<span class="co">#&gt; alternative hypothesis: two.sided</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;    prop 1    prop 2    prop 3 </span>
<span class="co">#&gt; 0.1809117 0.1504178 0.2076814</span>
</pre></div>
</div>
<div id="main-regression-tables" class="section level1">
<h1 class="hasAnchor">
<a href="#main-regression-tables" class="anchor"></a>Main regression tables</h1>
<div id="work-and-treatments" class="section level2">
<h2 class="hasAnchor">
<a href="#work-and-treatments" class="anchor"></a>Work and treatments</h2>
<p>We want to pool the work and no-work treatments, so it is a question of interest whether there are interaction effects between the work requirement and treatments.</p>
<div class="sourceCode" id="cb27"><pre class="downlit">
<span class="kw">w1</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">treatmentgroup</span><span class="op">*</span><span class="kw">workp</span> , data=<span class="kw">.</span>)
<span class="kw">w2</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">treatmentgroup</span><span class="op">*</span><span class="kw">workp</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span>
                             <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span>)
<span class="kw">w3</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">treatmentgroup</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span>
                             <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span>)
<span class="kw">w4</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">zero_to_worst_off</span> <span class="op">~</span> <span class="kw">treatmentgroup</span><span class="op">*</span><span class="kw">workp</span> , data=<span class="kw">.</span>)
<span class="kw">w5</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">zero_to_worst_off</span> <span class="op">~</span> <span class="kw">treatmentgroup</span><span class="op">*</span><span class="kw">workp</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span>
                             <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span>)
<span class="kw">w6</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">zero_to_worst_off</span> <span class="op">~</span> <span class="kw">treatmentgroup</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span>
                             <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span>)
</pre></div>
<p>We want to test the joint significance of the interactions</p>
<div class="sourceCode" id="cb28"><pre class="downlit">
<span class="kw">w1t</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">w1</span>, linfct= <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"`treatmentgroupForced Choice:workpTRUE` = 0"</span>,
                          <span class="st">"`treatmentgroupNominal Choice:workpTRUE` = 0"</span>),
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">w1</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))
<span class="kw">w2t</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">w2</span>, linfct= <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"`treatmentgroupForced Choice:workpTRUE` = 0"</span>,
                          <span class="st">"`treatmentgroupNominal Choice:workpTRUE` = 0"</span>),
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">w2</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))
<span class="kw">w4t</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">w4</span>, linfct= <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"`treatmentgroupForced Choice:workpTRUE` = 0"</span>,
                          <span class="st">"`treatmentgroupNominal Choice:workpTRUE` = 0"</span>),
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">w4</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))
<span class="kw">w5t</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">w5</span>, linfct= <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"`treatmentgroupForced Choice:workpTRUE` = 0"</span>,
                          <span class="st">"`treatmentgroupNominal Choice:workpTRUE` = 0"</span>),
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">w5</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))

<span class="kw">wrow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Joint p-value on work-interactions:"</span>, 
          <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">w1t</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalue</span>[<span class="fl">1</span>]),
          <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">w2t</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalue</span>[<span class="fl">1</span>]), <span class="st">""</span>,
          <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">w4t</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalue</span>[<span class="fl">1</span>]),
          <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">w5t</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalue</span>[<span class="fl">1</span>]), <span class="st">""</span>)
</pre></div>
<p>Now for table output:</p>
<div class="sourceCode" id="cb29"><pre class="downlit">
<span class="fu">stargazer</span>(<span class="kw">w1</span>, <span class="kw">w2</span>, <span class="kw">w3</span>, <span class="kw">w4</span>, <span class="kw">w5</span>, <span class="kw">w6</span>, 
          se = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">w1</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))),
                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">w2</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))),
                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">w3</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))),
                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">w4</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))),
                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">w5</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))),
                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">w6</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>))))),
        add.lines=<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">wrow</span>),
        type=<span class="st">"text"</span>, style=<span class="st">"aer"</span>, df=<span class="fl">FALSE</span>, keep.stat=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"rsq"</span>,<span class="st">"n"</span>),
        p.auto=<span class="fl">TRUE</span>,
        order=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"treatmentgroup*"</span>, <span class="st">"workp"</span>),
        star.char=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>, <span class="st">""</span>,<span class="st">""</span>), notes=<span class="st">""</span>, notes.append=<span class="fl">FALSE</span>, report=<span class="st">"vcsp"</span>, header=<span class="fl">FALSE</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; ===============================================================================================</span>
<span class="co">#&gt;                                              inequality                 zero_to_worst_off      </span>
<span class="co">#&gt;                                        (1)       (2)       (3)       (4)       (5)       (6)   </span>
<span class="co">#&gt; -----------------------------------------------------------------------------------------------</span>
<span class="co">#&gt; treatmentgroupForced Choice           0.169     0.164     0.162     0.155     0.152     0.127  </span>
<span class="co">#&gt;                                      (0.020)   (0.020)   (0.011)   (0.020)   (0.019)   (0.011) </span>
<span class="co">#&gt;                                     p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                </span>
<span class="co">#&gt; treatmentgroupNominal Choice          0.110     0.114     0.108     0.069     0.071     0.066  </span>
<span class="co">#&gt;                                      (0.019)   (0.019)   (0.013)   (0.018)   (0.018)   (0.012) </span>
<span class="co">#&gt;                                     p = 0.000 p = 0.000 p = 0.000 p = 0.001 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                </span>
<span class="co">#&gt; treatmentgroupForced Choice:workp    -0.004    -0.004              -0.040    -0.040            </span>
<span class="co">#&gt;                                      (0.024)   (0.024)             (0.023)   (0.023)           </span>
<span class="co">#&gt;                                     p = 0.863 p = 0.864           p = 0.086 p = 0.079          </span>
<span class="co">#&gt;                                                                                                </span>
<span class="co">#&gt; treatmentgroupNominal Choice:workp   -0.003    -0.011              -0.004    -0.010            </span>
<span class="co">#&gt;                                      (0.026)   (0.025)             (0.024)   (0.024)           </span>
<span class="co">#&gt;                                     p = 0.919 p = 0.648           p = 0.868 p = 0.687          </span>
<span class="co">#&gt;                                                                                                </span>
<span class="co">#&gt; workp                                -0.065    -0.064    -0.069    -0.040    -0.039    -0.059  </span>
<span class="co">#&gt;                                      (0.017)   (0.016)   (0.010)   (0.015)   (0.014)   (0.010) </span>
<span class="co">#&gt;                                     p = 0.000 p = 0.000 p = 0.000 p = 0.007 p = 0.008 p = 0.000</span>
<span class="co">#&gt;                                                                                                </span>
<span class="co">#&gt; leftp                                          -0.064    -0.064              -0.047    -0.047  </span>
<span class="co">#&gt;                                                (0.011)   (0.011)             (0.011)   (0.011) </span>
<span class="co">#&gt;                                               p = 0.000 p = 0.000           p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                </span>
<span class="co">#&gt; female                                         -0.084    -0.084              -0.044    -0.044  </span>
<span class="co">#&gt;                                                (0.010)   (0.010)             (0.010)   (0.010) </span>
<span class="co">#&gt;                                               p = 0.000 p = 0.000           p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                </span>
<span class="co">#&gt; age_h                                          -0.078    -0.078              -0.057    -0.057  </span>
<span class="co">#&gt;                                                (0.010)   (0.010)             (0.009)   (0.009) </span>
<span class="co">#&gt;                                               p = 0.000 p = 0.000           p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                </span>
<span class="co">#&gt; crt_h                                           0.059     0.059               0.052     0.051  </span>
<span class="co">#&gt;                                                (0.010)   (0.010)             (0.010)   (0.010) </span>
<span class="co">#&gt;                                               p = 0.000 p = 0.000           p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                </span>
<span class="co">#&gt; university                                      0.015     0.016               0.021     0.021  </span>
<span class="co">#&gt;                                                (0.010)   (0.010)             (0.010)   (0.010) </span>
<span class="co">#&gt;                                               p = 0.125 p = 0.123           p = 0.033 p = 0.033</span>
<span class="co">#&gt;                                                                                                </span>
<span class="co">#&gt; high_income                                     0.050     0.050               0.049     0.049  </span>
<span class="co">#&gt;                                                (0.011)   (0.011)             (0.011)   (0.011) </span>
<span class="co">#&gt;                                               p = 0.000 p = 0.000           p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                </span>
<span class="co">#&gt; Constant                              0.199     0.266     0.269     0.104     0.131     0.141  </span>
<span class="co">#&gt;                                      (0.013)   (0.018)   (0.016)   (0.011)   (0.017)   (0.015) </span>
<span class="co">#&gt;                                     p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                </span>
<span class="co">#&gt; Joint p-value on work-interactions:   0.979     0.979               0.157     0.144            </span>
<span class="co">#&gt; Observations                          5,757     5,757     5,757     5,757     5,757     5,757  </span>
<span class="co">#&gt; R2                                    0.033     0.084     0.084     0.023     0.055     0.054  </span>
<span class="co">#&gt; -----------------------------------------------------------------------------------------------</span>
<span class="co">#&gt; Notes:</span>
</pre></div>
<p>From this we conclude that we can pool the work/no-work treatments, and simplify with only a dummy for work condition as a level shifter.</p>
<p>Writing the results also to a latex file.</p>
</div>
<div id="the-role-of-choice" class="section level2">
<h2 class="hasAnchor">
<a href="#the-role-of-choice" class="anchor"></a>The role of choice</h2>
<p>The first regression table just regress inequality (and zero to the worst off) on treatment indicators and demographics (Table 1 in submitted version).</p>
<p>We want the main table for the paper to pool work/no-work completely.</p>
<div class="sourceCode" id="cb30"><pre class="downlit">
<span class="kw">t1ineq_1</span> <span class="op">&lt;-</span>  <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">treatmentgroup</span> <span class="op">+</span> <span class="kw">workp</span> , data = <span class="kw">.</span> )
<span class="kw">t1ineq_2</span> <span class="op">&lt;-</span>  <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">treatmentgroup</span> <span class="op">+</span> <span class="kw">workp</span>  <span class="op">+</span>
                             <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span>, data=<span class="kw">.</span>)
<span class="kw">t1ineq_3</span> <span class="op">&lt;-</span>  <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">treatmentgroup</span>  <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span>
                             <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span>
                             <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span>)

<span class="kw">t1noth_1</span> <span class="op">&lt;-</span>  <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>( <span class="kw">zero_to_worst_off</span> <span class="op">~</span> <span class="kw">treatmentgroup</span> <span class="op">+</span> <span class="kw">workp</span>, data = <span class="kw">.</span> )
<span class="kw">t1noth_2</span>  <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>( <span class="kw">zero_to_worst_off</span> <span class="op">~</span> <span class="kw">treatmentgroup</span> <span class="op">+</span> <span class="kw">workp</span>  <span class="op">+</span>
                              <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span>, data=<span class="kw">.</span>)
<span class="kw">t1noth_3</span>  <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>( <span class="kw">zero_to_worst_off</span> <span class="op">~</span> <span class="kw">treatmentgroup</span>  <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span>
                              <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span>
                              <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span>)
</pre></div>
<p>Now, outputting these regressions to a table.</p>
<div class="sourceCode" id="cb31"><pre class="downlit">
<span class="fu">stargazer</span>(<span class="kw">t1ineq_1</span>, <span class="kw">t1ineq_2</span>, <span class="kw">t1ineq_3</span>, <span class="kw">t1noth_1</span>, <span class="kw">t1noth_2</span>, <span class="kw">t1noth_3</span>,
          se = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">t1ineq_1</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))),
                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">t1ineq_2</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))),
                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">t1ineq_3</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))),
                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">t1noth_1</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))),
                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">t1noth_2</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))),
                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">t1noth_3</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>))))),
         type=<span class="st">"text"</span>, style=<span class="st">"aer"</span>, df=<span class="fl">FALSE</span>, keep.stat=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"rsq"</span>,<span class="st">"n"</span>),
        p.auto=<span class="fl">TRUE</span>,
        star.char=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>, <span class="st">""</span>,<span class="st">""</span>), notes=<span class="st">""</span>, notes.append=<span class="fl">FALSE</span>, report=<span class="st">"vcsp"</span>, header=<span class="fl">FALSE</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; ========================================================================================</span>
<span class="co">#&gt;                                       inequality                 zero_to_worst_off      </span>
<span class="co">#&gt;                                 (1)       (2)       (3)       (4)       (5)       (6)   </span>
<span class="co">#&gt; ----------------------------------------------------------------------------------------</span>
<span class="co">#&gt; treatmentgroupForced Choice    0.166     0.162     0.162     0.130     0.127     0.127  </span>
<span class="co">#&gt;                               (0.011)   (0.011)   (0.011)   (0.011)   (0.011)   (0.011) </span>
<span class="co">#&gt;                              p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; treatmentgroupNominal Choice   0.109     0.108     0.108     0.066     0.066     0.066  </span>
<span class="co">#&gt;                               (0.013)   (0.013)   (0.013)   (0.012)   (0.012)   (0.012) </span>
<span class="co">#&gt;                              p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; workp                         -0.068    -0.069    -0.069    -0.058    -0.059    -0.059  </span>
<span class="co">#&gt;                               (0.011)   (0.010)   (0.010)   (0.010)   (0.010)   (0.010) </span>
<span class="co">#&gt;                              p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; leftp                                   -0.067    -0.064              -0.050    -0.047  </span>
<span class="co">#&gt;                                         (0.011)   (0.011)             (0.011)   (0.011) </span>
<span class="co">#&gt;                                        p = 0.000 p = 0.000           p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; female                                  -0.094    -0.084              -0.054    -0.044  </span>
<span class="co">#&gt;                                         (0.010)   (0.010)             (0.010)   (0.010) </span>
<span class="co">#&gt;                                        p = 0.000 p = 0.000           p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; age_h                                   -0.077    -0.078              -0.056    -0.057  </span>
<span class="co">#&gt;                                         (0.010)   (0.010)             (0.009)   (0.009) </span>
<span class="co">#&gt;                                        p = 0.000 p = 0.000           p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; crt_h                                    0.066     0.059               0.059     0.051  </span>
<span class="co">#&gt;                                         (0.010)   (0.010)             (0.010)   (0.010) </span>
<span class="co">#&gt;                                        p = 0.000 p = 0.000           p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; university                                         0.016                         0.021  </span>
<span class="co">#&gt;                                                   (0.010)                       (0.010) </span>
<span class="co">#&gt;                                                  p = 0.123                     p = 0.033</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; high_income                                        0.050                         0.049  </span>
<span class="co">#&gt;                                                   (0.011)                       (0.011) </span>
<span class="co">#&gt;                                                  p = 0.000                     p = 0.000</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; Constant                       0.201     0.299     0.269     0.113     0.174     0.141  </span>
<span class="co">#&gt;                               (0.010)   (0.015)   (0.016)   (0.009)   (0.015)   (0.015) </span>
<span class="co">#&gt;                              p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; Observations                   5,757     5,757     5,757     5,757     5,757     5,757  </span>
<span class="co">#&gt; R2                             0.033     0.080     0.084     0.023     0.049     0.054  </span>
<span class="co">#&gt; ----------------------------------------------------------------------------------------</span>
<span class="co">#&gt; Notes:</span>
</pre></div>
<p>And to disk:</p>
<div id="variant-with-only-work-and-strict-forced-choice" class="section level3">
<h3 class="hasAnchor">
<a href="#variant-with-only-work-and-strict-forced-choice" class="anchor"></a>Variant with only work and strict forced choice</h3>
<div class="sourceCode" id="cb32"><pre class="downlit">
<span class="kw">df_kwK</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">treatment_org</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Base (w)"</span>,
                                               <span class="st">"Nominal Choice (w)"</span>,
                                               <span class="st">"Forced Choice (w)"</span>, 
                                               <span class="st">"Forced Choice strong"</span>,
                                               <span class="st">"Forced Choice very strong"</span>))
<span class="kw">t1ineq_1v</span> <span class="op">&lt;-</span>  <span class="kw">df_kwK</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">treatmentgroup</span>  , data = <span class="kw">.</span> )
<span class="kw">t1ineq_2v</span> <span class="op">&lt;-</span>  <span class="kw">df_kwK</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">treatmentgroup</span>   <span class="op">+</span>
                             <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span>, data=<span class="kw">.</span>)
<span class="kw">t1ineq_3v</span> <span class="op">&lt;-</span>  <span class="kw">df_kwK</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">treatmentgroup</span>  <span class="op">+</span>
                             <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span>
                             <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span>)

<span class="kw">t1noth_1v</span> <span class="op">&lt;-</span>  <span class="kw">df_kwK</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>( <span class="kw">zero_to_worst_off</span> <span class="op">~</span> <span class="kw">treatmentgroup</span> , data = <span class="kw">.</span> )
<span class="kw">t1noth_2v</span>  <span class="op">&lt;-</span> <span class="kw">df_kwK</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>( <span class="kw">zero_to_worst_off</span> <span class="op">~</span> <span class="kw">treatmentgroup</span>   <span class="op">+</span>
                              <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span>, data=<span class="kw">.</span>)
<span class="kw">t1noth_3v</span>  <span class="op">&lt;-</span> <span class="kw">df_kwK</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>( <span class="kw">zero_to_worst_off</span> <span class="op">~</span> <span class="kw">treatmentgroup</span>  <span class="op">+</span>
                              <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span>
                              <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span>)
</pre></div>
<p>Now, outputting these regressions to a table.</p>
<div class="sourceCode" id="cb33"><pre class="downlit">
<span class="fu">stargazer</span>(<span class="kw">t1ineq_1v</span>, <span class="kw">t1ineq_2v</span>, <span class="kw">t1ineq_3v</span>, <span class="kw">t1noth_1v</span>, <span class="kw">t1noth_2v</span>, <span class="kw">t1noth_3v</span>,
          se = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">t1ineq_1v</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_kwK</span>)))),
                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">t1ineq_2v</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_kwK</span>)))),
                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">t1ineq_3v</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_kwK</span>)))),
                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">t1noth_1v</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_kwK</span>)))),
                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">t1noth_2v</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_kwK</span>)))),
                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">t1noth_3v</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_kwK</span>))))),
         type=<span class="st">"text"</span>, style=<span class="st">"aer"</span>, df=<span class="fl">FALSE</span>, keep.stat=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"rsq"</span>,<span class="st">"n"</span>),
        p.auto=<span class="fl">TRUE</span>,
        star.char=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>, <span class="st">""</span>,<span class="st">""</span>), notes=<span class="st">""</span>, notes.append=<span class="fl">FALSE</span>, report=<span class="st">"vcsp"</span>, header=<span class="fl">FALSE</span>,
        out = <span class="fu">here</span>(<span class="st">"tables"</span>, <span class="st">"main_onlinev.tex"</span>))
<span class="co">#&gt; </span>
<span class="co">#&gt; ========================================================================================</span>
<span class="co">#&gt;                                       inequality                 zero_to_worst_off      </span>
<span class="co">#&gt;                                 (1)       (2)       (3)       (4)       (5)       (6)   </span>
<span class="co">#&gt; ----------------------------------------------------------------------------------------</span>
<span class="co">#&gt; treatmentgroupForced Choice    0.165     0.160     0.160     0.115     0.112     0.112  </span>
<span class="co">#&gt;                               (0.014)   (0.013)   (0.013)   (0.012)   (0.012)   (0.012) </span>
<span class="co">#&gt;                              p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; treatmentgroupNominal Choice   0.108     0.102     0.102     0.065     0.061     0.061  </span>
<span class="co">#&gt;                               (0.017)   (0.017)   (0.017)   (0.015)   (0.015)   (0.015) </span>
<span class="co">#&gt;                              p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; leftp                                   -0.062    -0.058              -0.049    -0.045  </span>
<span class="co">#&gt;                                         (0.013)   (0.013)             (0.013)   (0.013) </span>
<span class="co">#&gt;                                        p = 0.000 p = 0.000           p = 0.001 p = 0.001</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; female                                  -0.093    -0.081              -0.045    -0.033  </span>
<span class="co">#&gt;                                         (0.012)   (0.013)             (0.012)   (0.012) </span>
<span class="co">#&gt;                                        p = 0.000 p = 0.000           p = 0.001 p = 0.005</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; age_h                                   -0.074    -0.075              -0.050    -0.050  </span>
<span class="co">#&gt;                                         (0.012)   (0.012)             (0.011)   (0.011) </span>
<span class="co">#&gt;                                        p = 0.000 p = 0.000           p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; crt_h                                    0.062     0.057               0.053     0.048  </span>
<span class="co">#&gt;                                         (0.012)   (0.012)             (0.012)   (0.012) </span>
<span class="co">#&gt;                                        p = 0.000 p = 0.000           p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; university                                         0.009                         0.010  </span>
<span class="co">#&gt;                                                   (0.013)                       (0.012) </span>
<span class="co">#&gt;                                                  p = 0.471                     p = 0.387</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; high_income                                        0.059                         0.056  </span>
<span class="co">#&gt;                                                   (0.014)                       (0.014) </span>
<span class="co">#&gt;                                                  p = 0.000                     p = 0.000</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; Constant                       0.134     0.229     0.197     0.064     0.119     0.088  </span>
<span class="co">#&gt;                               (0.010)   (0.017)   (0.018)   (0.009)   (0.016)   (0.017) </span>
<span class="co">#&gt;                              p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; Observations                   3,581     3,581     3,581     3,581     3,581     3,581  </span>
<span class="co">#&gt; R2                             0.030     0.074     0.080     0.017     0.038     0.045  </span>
<span class="co">#&gt; ----------------------------------------------------------------------------------------</span>
<span class="co">#&gt; Notes:</span>
</pre></div>
</div>
</div>
<div id="heterogeneity-in-effects" class="section level2">
<h2 class="hasAnchor">
<a href="#heterogeneity-in-effects" class="anchor"></a>Heterogeneity in effects</h2>
<p>In the new heterogeneity table, we treat the background variables symmetrically.</p>
<div id="heterogeneity-in-effects-on-inequality" class="section level3">
<h3 class="hasAnchor">
<a href="#heterogeneity-in-effects-on-inequality" class="anchor"></a>Heterogeneity in effects on inequality</h3>
<div class="sourceCode" id="cb34"><pre class="downlit">
<span class="kw">h1_1</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span>  <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, 
                      data=<span class="kw">.</span> )
<span class="kw">h1_2</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span>  <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">leftp</span>, data=<span class="kw">.</span> )
<span class="kw">h1_3</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span>  <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">female</span> , data=<span class="kw">.</span> )
<span class="kw">h1_4</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">age_h</span>, data=<span class="kw">.</span> )
<span class="kw">h1_5</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span>  <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">crt_h</span>, data=<span class="kw">.</span> )
<span class="kw">h1_6</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span>  <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">university</span>, data=<span class="kw">.</span> )
<span class="kw">h1_7</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span>  <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">high_income</span>, data=<span class="kw">.</span> )
<span class="kw">h1_8</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span>  <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">leftp</span> <span class="op">+</span> <span class="kw">choice</span><span class="op">*</span><span class="kw">female</span> <span class="op">+</span> <span class="kw">choice</span><span class="op">*</span><span class="kw">age_h</span> <span class="op">+</span> <span class="kw">choice</span><span class="op">*</span><span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">choice</span><span class="op">*</span><span class="kw">university</span> <span class="op">+</span> 
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">high_income</span>, data=<span class="kw">.</span> )
</pre></div>
<p>Want to include linear combinations for the columns 2-7:</p>
<div class="sourceCode" id="cb35"><pre class="downlit">
<span class="kw">ch2</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">h1_2</span>, linfct=<span class="st">"choiceTRUE + choiceTRUE:leftpTRUE = 0"</span>, 
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">h1_2</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))
<span class="kw">ch3</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">h1_3</span>, linfct=<span class="st">"choiceTRUE + choiceTRUE:femaleTRUE = 0"</span>, 
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">h1_3</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))
<span class="kw">ch4</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">h1_4</span>, linfct=<span class="st">"choiceTRUE + choiceTRUE:age_hTRUE = 0"</span>, 
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">h1_4</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))
<span class="kw">ch5</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">h1_5</span>, linfct=<span class="st">"choiceTRUE + choiceTRUE:crt_hTRUE = 0"</span>, 
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">h1_5</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))
<span class="kw">ch6</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">h1_6</span>, linfct=<span class="st">"choiceTRUE + choiceTRUE:universityTRUE = 0"</span>, 
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">h1_6</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))
<span class="kw">ch7</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">h1_7</span>, linfct=<span class="st">"choiceTRUE + choiceTRUE:high_incomeTRUE = 0"</span>, 
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">h1_7</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))
<span class="kw">sh1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Linear combination"</span>,<span class="st">" "</span>, 
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">ch2</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">coefficients</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">ch3</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">coefficients</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">ch4</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">coefficients</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">ch5</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">coefficients</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">ch6</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">coefficients</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">ch7</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">coefficients</span>[<span class="fl">1</span>]),
        <span class="st">""</span>)
<span class="kw">sh2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>,<span class="st">""</span>,
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"(%4.3f)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">ch2</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">sigma</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"(%4.3f)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">ch3</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">sigma</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"(%4.3f)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">ch4</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">sigma</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"(%4.3f)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">ch5</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">sigma</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"(%4.3f)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">ch6</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">sigma</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"(%4.3f)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">ch7</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">sigma</span>[<span class="fl">1</span>]),
        <span class="st">""</span>)
<span class="kw">sh3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>, <span class="st">""</span>,
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"p=%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">ch2</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalues</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"p=%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">ch3</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalues</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"p=%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">ch4</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalues</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"p=%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">ch5</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalues</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"p=%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">ch6</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalues</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"p=%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">ch7</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalues</span>[<span class="fl">1</span>]),
        <span class="st">""</span>)
</pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit">
<span class="fu">stargazer</span>( <span class="kw">h1_1</span>, <span class="kw">h1_2</span>, <span class="kw">h1_3</span>, <span class="kw">h1_4</span>, <span class="kw">h1_5</span>, <span class="kw">h1_6</span>, <span class="kw">h1_7</span>, <span class="kw">h1_8</span>,
           se = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>( <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">h1_1</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">h1_1</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">h1_2</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">h1_2</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">h1_3</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">h1_3</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">h1_4</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">h1_4</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">h1_5</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">h1_5</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">h1_6</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">h1_6</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">h1_7</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">h1_7</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">h1_8</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">h1_8</span><span class="op">$</span><span class="kw">residuals</span>))))),
        order=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"choice"</span>,<span class="st">"choiceTRUE:leftp"</span>,<span class="st">"choiceTRUE:female"</span>, <span class="st">"choiceTRUE:age_h"</span>,
                <span class="st">"choiceTRUE:crt_h"</span>, <span class="st">"choiceTRUE:universityTRUE"</span>, <span class="st">"choiceTRUE:high_incomeTRUE"</span>),
        add.lines=<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">sh1</span>,<span class="kw">sh2</span>,<span class="kw">sh3</span>), 
        type=<span class="st">"text"</span>, style=<span class="st">"aer"</span>, df=<span class="fl">FALSE</span>, keep.stat=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"rsq"</span>,<span class="st">"n"</span>),
        p.auto=<span class="fl">TRUE</span>,
        star.char=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>, <span class="st">""</span>,<span class="st">""</span>), notes=<span class="st">""</span>, notes.append=<span class="fl">FALSE</span>, report=<span class="st">"vcsp"</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; ======================================================================================================</span>
<span class="co">#&gt;                                                          inequality                                   </span>
<span class="co">#&gt;                           (1)       (2)       (3)       (4)       (5)       (6)       (7)       (8)   </span>
<span class="co">#&gt; ------------------------------------------------------------------------------------------------------</span>
<span class="co">#&gt; choice                   0.134     0.149     0.152     0.162     0.114     0.132     0.124     0.168  </span>
<span class="co">#&gt;                         (0.010)   (0.019)   (0.015)   (0.014)   (0.013)   (0.015)   (0.012)   (0.029) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; choiceTRUE:leftp                  -0.022                                                      -0.016  </span>
<span class="co">#&gt;                                   (0.023)                                                     (0.023) </span>
<span class="co">#&gt;                                  p = 0.327                                                   p = 0.474</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; choiceTRUE:female                           -0.038                                            -0.027  </span>
<span class="co">#&gt;                                             (0.020)                                           (0.021) </span>
<span class="co">#&gt;                                            p = 0.058                                         p = 0.197</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; choiceTRUE:age_h                                      -0.062                                  -0.059  </span>
<span class="co">#&gt;                                                       (0.020)                                 (0.020) </span>
<span class="co">#&gt;                                                      p = 0.002                               p = 0.004</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; choiceTRUE:crt_h                                                 0.042                         0.028  </span>
<span class="co">#&gt;                                                                 (0.020)                       (0.021) </span>
<span class="co">#&gt;                                                                p = 0.038                     p = 0.173</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; choiceTRUE:university                                                      0.003              -0.004  </span>
<span class="co">#&gt;                                                                           (0.020)             (0.021) </span>
<span class="co">#&gt;                                                                          p = 0.881           p = 0.843</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; choiceTRUE:high_income                                                               0.028     0.018  </span>
<span class="co">#&gt;                                                                                     (0.022)   (0.024) </span>
<span class="co">#&gt;                                                                                    p = 0.204 p = 0.449</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; leftp                   -0.063    -0.046    -0.063    -0.063    -0.063    -0.063    -0.063    -0.051  </span>
<span class="co">#&gt;                         (0.011)   (0.019)   (0.011)   (0.011)   (0.011)   (0.011)   (0.011)   (0.019) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.014 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.007</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; crt_h                    0.059     0.059     0.059     0.059     0.028     0.059     0.060     0.038  </span>
<span class="co">#&gt;                         (0.010)   (0.010)   (0.010)   (0.010)   (0.017)   (0.010)   (0.010)   (0.017) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.098 p = 0.000 p = 0.000 p = 0.024</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; female                  -0.083    -0.083    -0.055    -0.084    -0.083    -0.083    -0.083    -0.063  </span>
<span class="co">#&gt;                         (0.010)   (0.010)   (0.017)   (0.010)   (0.010)   (0.010)   (0.010)   (0.017) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.000 p = 0.001 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.001</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; age_h                   -0.079    -0.079    -0.079    -0.033    -0.079    -0.079    -0.079    -0.035  </span>
<span class="co">#&gt;                         (0.010)   (0.010)   (0.010)   (0.016)   (0.010)   (0.010)   (0.010)   (0.016) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.000 p = 0.000 p = 0.046 p = 0.000 p = 0.000 p = 0.000 p = 0.035</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; university               0.016     0.016     0.016     0.017     0.016     0.014     0.016     0.020  </span>
<span class="co">#&gt;                         (0.010)   (0.010)   (0.010)   (0.010)   (0.010)   (0.017)   (0.010)   (0.017) </span>
<span class="co">#&gt;                        p = 0.113 p = 0.115 p = 0.113 p = 0.101 p = 0.116 p = 0.406 p = 0.113 p = 0.244</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; high_income              0.050     0.050     0.049     0.049     0.050     0.050     0.029     0.035  </span>
<span class="co">#&gt;                         (0.011)   (0.011)   (0.011)   (0.011)   (0.011)   (0.011)   (0.019)   (0.019) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.124 p = 0.068</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; Constant                 0.232     0.221     0.219     0.212     0.247     0.234     0.239     0.207  </span>
<span class="co">#&gt;                         (0.015)   (0.019)   (0.017)   (0.017)   (0.016)   (0.017)   (0.016)   (0.023) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; Linear combination                 0.127     0.114     0.099     0.157     0.135     0.152            </span>
<span class="co">#&gt;                                   (0.012)   (0.013)   (0.014)   (0.016)   (0.014)   (0.019)           </span>
<span class="co">#&gt;                                   p=0.000   p=0.000   p=0.000   p=0.000   p=0.000   p=0.000           </span>
<span class="co">#&gt; Observations             5,757     5,757     5,757     5,757     5,757     5,757     5,757     5,757  </span>
<span class="co">#&gt; R2                       0.075     0.076     0.076     0.077     0.076     0.075     0.076     0.078  </span>
<span class="co">#&gt; ------------------------------------------------------------------------------------------------------</span>
<span class="co">#&gt; Notes:</span>
</pre></div>
<p>Now to latex table on file</p>
</div>
<div id="restricting-heterogeneity-table-to-nominal-choice" class="section level3">
<h3 class="hasAnchor">
<a href="#restricting-heterogeneity-table-to-nominal-choice" class="anchor"></a>Restricting heterogeneity table to Nominal Choice</h3>
<p>For the appendix, we want to show heterogeneity with respect to each of the types of choice separately. First, restricting to nominal choice.</p>
<div class="sourceCode" id="cb37"><pre class="downlit">
<span class="kw">dfmain_nc</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">treatmentgroup</span> != <span class="st">"Forced Choice"</span>)
</pre></div>
<p>The regression tables are the same on this more restricted sample.</p>
<div class="sourceCode" id="cb38"><pre class="downlit">
<span class="kw">hnc1_1</span> <span class="op">&lt;-</span> <span class="kw">dfmain_nc</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, 
                      data=<span class="kw">.</span> )
<span class="kw">hnc1_2</span> <span class="op">&lt;-</span> <span class="kw">dfmain_nc</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">leftp</span>, data=<span class="kw">.</span> )
<span class="kw">hnc1_3</span> <span class="op">&lt;-</span> <span class="kw">dfmain_nc</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">female</span> , data=<span class="kw">.</span> )
<span class="kw">hnc1_4</span> <span class="op">&lt;-</span> <span class="kw">dfmain_nc</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">age_h</span>, data=<span class="kw">.</span> )
<span class="kw">hnc1_5</span> <span class="op">&lt;-</span> <span class="kw">dfmain_nc</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">crt_h</span>, data=<span class="kw">.</span> )
<span class="kw">hnc1_6</span> <span class="op">&lt;-</span> <span class="kw">dfmain_nc</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">university</span>, data=<span class="kw">.</span> )
<span class="kw">hnc1_7</span> <span class="op">&lt;-</span> <span class="kw">dfmain_nc</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">high_income</span>, data=<span class="kw">.</span> )
<span class="kw">hnc1_8</span> <span class="op">&lt;-</span> <span class="kw">dfmain_nc</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">leftp</span> <span class="op">+</span> <span class="kw">choice</span><span class="op">*</span><span class="kw">female</span> <span class="op">+</span> <span class="kw">choice</span><span class="op">*</span><span class="kw">age_h</span> <span class="op">+</span> <span class="kw">choice</span><span class="op">*</span><span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">choice</span><span class="op">*</span><span class="kw">university</span> <span class="op">+</span> 
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">high_income</span>, data=<span class="kw">.</span> )
</pre></div>
<p>Want to include linear combinations for the columns 2-7:</p>
<div class="sourceCode" id="cb39"><pre class="downlit">
<span class="kw">nch2</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">hnc1_2</span>, linfct=<span class="st">"choiceTRUE + choiceTRUE:leftpTRUE = 0"</span>, 
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">hnc1_2</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">dfmain_nc</span>)))
<span class="kw">nch3</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">hnc1_3</span>, linfct=<span class="st">"choiceTRUE + choiceTRUE:femaleTRUE = 0"</span>, 
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">hnc1_3</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">dfmain_nc</span>)))
<span class="kw">nch4</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">hnc1_4</span>, linfct=<span class="st">"choiceTRUE + choiceTRUE:age_hTRUE = 0"</span>, 
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">hnc1_4</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">dfmain_nc</span>)))
<span class="kw">nch5</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">hnc1_5</span>, linfct=<span class="st">"choiceTRUE + choiceTRUE:crt_hTRUE = 0"</span>, 
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">hnc1_5</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">dfmain_nc</span>)))
<span class="kw">nch6</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">hnc1_6</span>, linfct=<span class="st">"choiceTRUE + choiceTRUE:universityTRUE = 0"</span>, 
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">hnc1_6</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">dfmain_nc</span>)))
<span class="kw">nch7</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">hnc1_7</span>, linfct=<span class="st">"choiceTRUE + choiceTRUE:high_incomeTRUE = 0"</span>, 
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">hnc1_7</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">dfmain_nc</span>)))
<span class="kw">nsh1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Linear combination"</span>,<span class="st">" "</span>, 
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">nch2</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">coefficients</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">nch3</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">coefficients</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">nch4</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">coefficients</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">nch5</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">coefficients</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">nch6</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">coefficients</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">nch7</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">coefficients</span>[<span class="fl">1</span>]),
        <span class="st">""</span>)
<span class="kw">nsh2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>,<span class="st">""</span>,
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"(%4.3f)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">nch2</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">sigma</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"(%4.3f)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">nch3</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">sigma</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"(%4.3f)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">nch4</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">sigma</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"(%4.3f)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">nch5</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">sigma</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"(%4.3f)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">nch6</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">sigma</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"(%4.3f)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">nch7</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">sigma</span>[<span class="fl">1</span>]),
        <span class="st">""</span>)
<span class="kw">nsh3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>, <span class="st">""</span>,
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"p=%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">nch2</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalues</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"p=%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">nch3</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalues</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"p=%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">nch4</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalues</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"p=%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">nch5</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalues</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"p=%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">nch6</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalues</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"p=%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">nch7</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalues</span>[<span class="fl">1</span>]),
        <span class="st">""</span>)
</pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit">
<span class="fu">stargazer</span>( <span class="kw">hnc1_1</span>, <span class="kw">hnc1_2</span>, <span class="kw">hnc1_3</span>, <span class="kw">hnc1_4</span>, <span class="kw">hnc1_5</span>, <span class="kw">hnc1_6</span>, <span class="kw">hnc1_7</span>, <span class="kw">hnc1_8</span>,
           se = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>( <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">hnc1_1</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">hnc1_1</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">hnc1_2</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">hnc1_2</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">hnc1_3</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">hnc1_3</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">hnc1_4</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">hnc1_4</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">hnc1_5</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">hnc1_5</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">hnc1_6</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">hnc1_6</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">hnc1_7</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">hnc1_7</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">hnc1_8</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">hnc1_8</span><span class="op">$</span><span class="kw">residuals</span>))))),
        order=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"choice"</span>,<span class="st">"choiceTRUE:leftp"</span>,<span class="st">"choiceTRUE:female"</span>, <span class="st">"choiceTRUE:age_h"</span>,
                <span class="st">"choiceTRUE:crt_h"</span>, <span class="st">"choiceTRUE:universityTRUE"</span>, <span class="st">"choiceTRUE:high_incomeTRUE"</span>),
        add.lines=<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">nsh1</span>,<span class="kw">nsh2</span>,<span class="kw">nsh3</span>), 
        type=<span class="st">"text"</span>, style=<span class="st">"aer"</span>, df=<span class="fl">FALSE</span>, keep.stat=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"rsq"</span>,<span class="st">"n"</span>),
        p.auto=<span class="fl">TRUE</span>,
        star.char=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>, <span class="st">""</span>,<span class="st">""</span>), notes=<span class="st">""</span>, notes.append=<span class="fl">FALSE</span>, report=<span class="st">"vcsp"</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; ======================================================================================================</span>
<span class="co">#&gt;                                                          inequality                                   </span>
<span class="co">#&gt;                           (1)       (2)       (3)       (4)       (5)       (6)       (7)       (8)   </span>
<span class="co">#&gt; ------------------------------------------------------------------------------------------------------</span>
<span class="co">#&gt; choice                   0.108     0.129     0.116     0.132     0.111     0.124     0.103     0.176  </span>
<span class="co">#&gt;                         (0.013)   (0.024)   (0.019)   (0.018)   (0.016)   (0.018)   (0.015)   (0.036) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; choiceTRUE:leftp                  -0.031                                                      -0.028  </span>
<span class="co">#&gt;                                   (0.028)                                                     (0.029) </span>
<span class="co">#&gt;                                  p = 0.272                                                   p = 0.327</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; choiceTRUE:female                           -0.017                                            -0.013  </span>
<span class="co">#&gt;                                             (0.025)                                           (0.026) </span>
<span class="co">#&gt;                                            p = 0.507                                         p = 0.625</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; choiceTRUE:age_h                                      -0.053                                  -0.056  </span>
<span class="co">#&gt;                                                       (0.025)                                 (0.025) </span>
<span class="co">#&gt;                                                      p = 0.034                               p = 0.026</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; choiceTRUE:crt_h                                                -0.007                        -0.013  </span>
<span class="co">#&gt;                                                                 (0.025)                       (0.026) </span>
<span class="co">#&gt;                                                                p = 0.797                     p = 0.614</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; choiceTRUE:university                                                     -0.028              -0.029  </span>
<span class="co">#&gt;                                                                           (0.025)             (0.026) </span>
<span class="co">#&gt;                                                                          p = 0.259           p = 0.262</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; choiceTRUE:high_income                                                               0.012     0.016  </span>
<span class="co">#&gt;                                                                                     (0.027)   (0.029) </span>
<span class="co">#&gt;                                                                                    p = 0.670 p = 0.594</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; leftp                   -0.064    -0.048    -0.064    -0.065    -0.064    -0.064    -0.064    -0.051  </span>
<span class="co">#&gt;                         (0.014)   (0.019)   (0.014)   (0.014)   (0.014)   (0.014)   (0.014)   (0.019) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.009 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.006</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; workp                   -0.070    -0.070    -0.070    -0.070    -0.070    -0.070    -0.070    -0.071  </span>
<span class="co">#&gt;                         (0.013)   (0.013)   (0.013)   (0.013)   (0.013)   (0.013)   (0.013)   (0.013) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; crt_h                    0.029     0.029     0.029     0.030     0.033     0.030     0.030     0.036  </span>
<span class="co">#&gt;                         (0.013)   (0.013)   (0.013)   (0.013)   (0.017)   (0.013)   (0.013)   (0.017) </span>
<span class="co">#&gt;                        p = 0.023 p = 0.023 p = 0.023 p = 0.022 p = 0.051 p = 0.022 p = 0.022 p = 0.031</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; female                  -0.071    -0.071    -0.063    -0.072    -0.071    -0.071    -0.071    -0.065  </span>
<span class="co">#&gt;                         (0.013)   (0.013)   (0.017)   (0.013)   (0.013)   (0.013)   (0.013)   (0.017) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.000 p = 0.001 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.001</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; age_h                   -0.061    -0.061    -0.061    -0.034    -0.061    -0.061    -0.061    -0.033  </span>
<span class="co">#&gt;                         (0.013)   (0.013)   (0.013)   (0.016)   (0.013)   (0.013)   (0.013)   (0.016) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.000 p = 0.000 p = 0.035 p = 0.000 p = 0.000 p = 0.000 p = 0.042</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; university               0.006     0.006     0.006     0.006     0.006     0.020     0.006     0.021  </span>
<span class="co">#&gt;                         (0.013)   (0.013)   (0.013)   (0.013)   (0.013)   (0.017)   (0.013)   (0.017) </span>
<span class="co">#&gt;                        p = 0.645 p = 0.651 p = 0.638 p = 0.639 p = 0.642 p = 0.220 p = 0.643 p = 0.206</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; high_income              0.044     0.045     0.044     0.044     0.044     0.044     0.039     0.035  </span>
<span class="co">#&gt;                         (0.015)   (0.015)   (0.015)   (0.015)   (0.015)   (0.015)   (0.019)   (0.019) </span>
<span class="co">#&gt;                        p = 0.003 p = 0.003 p = 0.003 p = 0.003 p = 0.003 p = 0.003 p = 0.041 p = 0.066</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; Constant                 0.276     0.266     0.272     0.266     0.275     0.268     0.278     0.244  </span>
<span class="co">#&gt;                         (0.020)   (0.022)   (0.021)   (0.020)   (0.020)   (0.021)   (0.020)   (0.024) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; Linear combination                 0.098     0.099     0.079     0.104     0.095     0.115            </span>
<span class="co">#&gt;                                   (0.015)   (0.017)   (0.018)   (0.020)   (0.017)   (0.023)           </span>
<span class="co">#&gt;                                   p=0.000   p=0.000   p=0.000   p=0.000   p=0.000   p=0.000           </span>
<span class="co">#&gt; Observations             2,893     2,893     2,893     2,893     2,893     2,893     2,893     2,893  </span>
<span class="co">#&gt; R2                       0.073     0.074     0.073     0.075     0.073     0.074     0.073     0.076  </span>
<span class="co">#&gt; ------------------------------------------------------------------------------------------------------</span>
<span class="co">#&gt; Notes:</span>
</pre></div>
<p>Now to latex table on file</p>
</div>
<div id="restricting-heterogeneity-table-to-forced-choice" class="section level3">
<h3 class="hasAnchor">
<a href="#restricting-heterogeneity-table-to-forced-choice" class="anchor"></a>Restricting heterogeneity table to Forced Choice</h3>
<p>For the appendix, we want to show heterogeneity with respect to each of the types of choice separately. Now, restricting to forced choice.</p>
<div class="sourceCode" id="cb41"><pre class="downlit">
<span class="kw">dfmain_fc</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">treatmentgroup</span> != <span class="st">"Nominal Choice"</span>)
</pre></div>
<p>The regression tables are the same on this more restricted sample.</p>
<div class="sourceCode" id="cb42"><pre class="downlit">
<span class="kw">hfc1_1</span> <span class="op">&lt;-</span> <span class="kw">dfmain_fc</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, 
                      data=<span class="kw">.</span> )
<span class="kw">hfc1_2</span> <span class="op">&lt;-</span> <span class="kw">dfmain_fc</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">leftp</span>, data=<span class="kw">.</span> )
<span class="kw">hfc1_3</span> <span class="op">&lt;-</span> <span class="kw">dfmain_fc</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">female</span> , data=<span class="kw">.</span> )
<span class="kw">hfc1_4</span> <span class="op">&lt;-</span> <span class="kw">dfmain_fc</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">age_h</span>, data=<span class="kw">.</span> )
<span class="kw">hfc1_5</span> <span class="op">&lt;-</span> <span class="kw">dfmain_fc</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">crt_h</span>, data=<span class="kw">.</span> )
<span class="kw">hfc1_6</span> <span class="op">&lt;-</span> <span class="kw">dfmain_fc</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">university</span>, data=<span class="kw">.</span> )
<span class="kw">hfc1_7</span> <span class="op">&lt;-</span> <span class="kw">dfmain_fc</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">high_income</span>, data=<span class="kw">.</span> )
<span class="kw">hfc1_8</span> <span class="op">&lt;-</span> <span class="kw">dfmain_fc</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">leftp</span> <span class="op">+</span> <span class="kw">choice</span><span class="op">*</span><span class="kw">female</span> <span class="op">+</span> <span class="kw">choice</span><span class="op">*</span><span class="kw">age_h</span> <span class="op">+</span> <span class="kw">choice</span><span class="op">*</span><span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">choice</span><span class="op">*</span><span class="kw">university</span> <span class="op">+</span> 
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">high_income</span>, data=<span class="kw">.</span> )
</pre></div>
<p>Want to include linear combinations for the columns 2-7:</p>
<div class="sourceCode" id="cb43"><pre class="downlit">
<span class="kw">fch2</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">hfc1_2</span>, linfct=<span class="st">"choiceTRUE + choiceTRUE:leftpTRUE = 0"</span>, 
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">hfc1_2</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">dfmain_fc</span>)))
<span class="kw">fch3</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">hfc1_3</span>, linfct=<span class="st">"choiceTRUE + choiceTRUE:femaleTRUE = 0"</span>, 
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">hfc1_3</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">dfmain_fc</span>)))
<span class="kw">fch4</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">hfc1_4</span>, linfct=<span class="st">"choiceTRUE + choiceTRUE:age_hTRUE = 0"</span>, 
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">hfc1_4</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">dfmain_fc</span>)))
<span class="kw">fch5</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">hfc1_5</span>, linfct=<span class="st">"choiceTRUE + choiceTRUE:crt_hTRUE = 0"</span>, 
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">hfc1_5</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">dfmain_fc</span>)))
<span class="kw">fch6</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">hfc1_6</span>, linfct=<span class="st">"choiceTRUE + choiceTRUE:universityTRUE = 0"</span>, 
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">hfc1_6</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">dfmain_fc</span>)))
<span class="kw">fch7</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">hfc1_7</span>, linfct=<span class="st">"choiceTRUE + choiceTRUE:high_incomeTRUE = 0"</span>, 
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">hfc1_7</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">dfmain_fc</span>)))
<span class="kw">fsh1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Linear combination"</span>,<span class="st">" "</span>, 
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">fch2</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">coefficients</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">fch3</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">coefficients</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">fch4</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">coefficients</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">fch5</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">coefficients</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">fch6</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">coefficients</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">fch7</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">coefficients</span>[<span class="fl">1</span>]),
        <span class="st">""</span>)
<span class="kw">fsh2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>,<span class="st">""</span>,
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"(%4.3f)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">fch2</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">sigma</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"(%4.3f)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">fch3</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">sigma</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"(%4.3f)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">fch4</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">sigma</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"(%4.3f)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">fch5</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">sigma</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"(%4.3f)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">fch6</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">sigma</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"(%4.3f)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">fch7</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">sigma</span>[<span class="fl">1</span>]),
        <span class="st">""</span>)
<span class="kw">fsh3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>, <span class="st">""</span>,
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"p=%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">fch2</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalues</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"p=%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">fch3</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalues</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"p=%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">fch4</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalues</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"p=%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">fch5</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalues</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"p=%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">fch6</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalues</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"p=%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">fch7</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalues</span>[<span class="fl">1</span>]),
        <span class="st">""</span>)
</pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit">
<span class="fu">stargazer</span>( <span class="kw">hfc1_1</span>, <span class="kw">hfc1_2</span>, <span class="kw">hfc1_3</span>, <span class="kw">hfc1_4</span>, <span class="kw">hfc1_5</span>, <span class="kw">hfc1_6</span>, <span class="kw">hfc1_7</span>, <span class="kw">hfc1_8</span>,
           se = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>( <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">hfc1_1</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">hfc1_1</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">hfc1_2</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">hfc1_2</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">hfc1_3</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">hfc1_3</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">hfc1_4</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">hfc1_4</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">hfc1_5</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">hfc1_5</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">hfc1_6</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">hfc1_6</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">hfc1_7</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">hfc1_7</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">hfc1_8</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">hfc1_8</span><span class="op">$</span><span class="kw">residuals</span>))))),
        order=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"choice"</span>,<span class="st">"choiceTRUE:leftp"</span>,<span class="st">"choiceTRUE:female"</span>, <span class="st">"choiceTRUE:age_h"</span>,
                <span class="st">"choiceTRUE:crt_h"</span>, <span class="st">"choiceTRUE:universityTRUE"</span>, <span class="st">"choiceTRUE:high_incomeTRUE"</span>),
        add.lines=<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">fsh1</span>,<span class="kw">fsh2</span>,<span class="kw">fsh3</span>), 
        type=<span class="st">"text"</span>, style=<span class="st">"aer"</span>, df=<span class="fl">FALSE</span>, keep.stat=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"rsq"</span>,<span class="st">"n"</span>),
        p.auto=<span class="fl">TRUE</span>,
        star.char=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>, <span class="st">""</span>,<span class="st">""</span>), notes=<span class="st">""</span>, notes.append=<span class="fl">FALSE</span>, report=<span class="st">"vcsp"</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; ======================================================================================================</span>
<span class="co">#&gt;                                                          inequality                                   </span>
<span class="co">#&gt;                           (1)       (2)       (3)       (4)       (5)       (6)       (7)       (8)   </span>
<span class="co">#&gt; ------------------------------------------------------------------------------------------------------</span>
<span class="co">#&gt; choice                   0.162     0.175     0.184     0.191     0.130     0.153     0.149     0.181  </span>
<span class="co">#&gt;                         (0.011)   (0.021)   (0.017)   (0.015)   (0.014)   (0.016)   (0.013)   (0.031) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; choiceTRUE:leftp                  -0.019                                                      -0.014  </span>
<span class="co">#&gt;                                   (0.024)                                                     (0.025) </span>
<span class="co">#&gt;                                  p = 0.431                                                   p = 0.583</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; choiceTRUE:female                           -0.047                                            -0.032  </span>
<span class="co">#&gt;                                             (0.022)                                           (0.023) </span>
<span class="co">#&gt;                                            p = 0.032                                         p = 0.165</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; choiceTRUE:age_h                                      -0.067                                  -0.062  </span>
<span class="co">#&gt;                                                       (0.022)                                 (0.022) </span>
<span class="co">#&gt;                                                      p = 0.003                               p = 0.006</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; choiceTRUE:crt_h                                                 0.068                         0.052  </span>
<span class="co">#&gt;                                                                 (0.022)                       (0.023) </span>
<span class="co">#&gt;                                                                p = 0.003                     p = 0.025</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; choiceTRUE:university                                                      0.015               0.005  </span>
<span class="co">#&gt;                                                                           (0.022)             (0.023) </span>
<span class="co">#&gt;                                                                          p = 0.481           p = 0.819</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; choiceTRUE:high_income                                                               0.037     0.019  </span>
<span class="co">#&gt;                                                                                     (0.024)   (0.026) </span>
<span class="co">#&gt;                                                                                    p = 0.128 p = 0.454</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; leftp                   -0.059    -0.046    -0.060    -0.060    -0.059    -0.059    -0.059    -0.051  </span>
<span class="co">#&gt;                         (0.013)   (0.019)   (0.013)   (0.013)   (0.013)   (0.013)   (0.013)   (0.019) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.013 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.006</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; workp                   -0.067    -0.067    -0.066    -0.067    -0.067    -0.067    -0.067    -0.067  </span>
<span class="co">#&gt;                         (0.012)   (0.012)   (0.012)   (0.012)   (0.012)   (0.012)   (0.012)   (0.012) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; crt_h                    0.071     0.071     0.071     0.070     0.025     0.071     0.071     0.036  </span>
<span class="co">#&gt;                         (0.012)   (0.012)   (0.012)   (0.012)   (0.017)   (0.012)   (0.012)   (0.017) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.129 p = 0.000 p = 0.000 p = 0.031</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; female                  -0.086    -0.086    -0.055    -0.086    -0.086    -0.086    -0.085    -0.065  </span>
<span class="co">#&gt;                         (0.012)   (0.012)   (0.017)   (0.012)   (0.012)   (0.012)   (0.012)   (0.017) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.000 p = 0.002 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.001</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; age_h                   -0.074    -0.074    -0.074    -0.030    -0.074    -0.074    -0.074    -0.033  </span>
<span class="co">#&gt;                         (0.011)   (0.011)   (0.011)   (0.016)   (0.011)   (0.011)   (0.011)   (0.016) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.000 p = 0.000 p = 0.068 p = 0.000 p = 0.000 p = 0.000 p = 0.041</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; university               0.024     0.024     0.024     0.025     0.024     0.013     0.024     0.021  </span>
<span class="co">#&gt;                         (0.012)   (0.012)   (0.012)   (0.012)   (0.012)   (0.017)   (0.012)   (0.017) </span>
<span class="co">#&gt;                        p = 0.041 p = 0.042 p = 0.042 p = 0.033 p = 0.042 p = 0.417 p = 0.042 p = 0.208</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; high_income              0.050     0.050     0.049     0.049     0.050     0.050     0.025     0.035  </span>
<span class="co">#&gt;                         (0.013)   (0.013)   (0.013)   (0.013)   (0.013)   (0.013)   (0.019)   (0.019) </span>
<span class="co">#&gt;                        p = 0.001 p = 0.001 p = 0.001 p = 0.001 p = 0.001 p = 0.001 p = 0.175 p = 0.066</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; Constant                 0.253     0.245     0.239     0.234     0.274     0.259     0.262     0.242  </span>
<span class="co">#&gt;                         (0.018)   (0.021)   (0.020)   (0.019)   (0.019)   (0.019)   (0.019)   (0.024) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; Linear combination                 0.156     0.137     0.124     0.199     0.168     0.185            </span>
<span class="co">#&gt;                                   (0.013)   (0.015)   (0.016)   (0.018)   (0.015)   (0.020)           </span>
<span class="co">#&gt;                                   p=0.000   p=0.000   p=0.000   p=0.000   p=0.000   p=0.000           </span>
<span class="co">#&gt; Observations             4,320     4,320     4,320     4,320     4,320     4,320     4,320     4,320  </span>
<span class="co">#&gt; R2                       0.095     0.095     0.096     0.096     0.097     0.095     0.095     0.099  </span>
<span class="co">#&gt; ------------------------------------------------------------------------------------------------------</span>
<span class="co">#&gt; Notes:</span>
</pre></div>
<p>Now to latex table on file</p>
</div>
<div id="heterogeneity-in-effects-on-zero-to-worst-off" class="section level3">
<h3 class="hasAnchor">
<a href="#heterogeneity-in-effects-on-zero-to-worst-off" class="anchor"></a>Heterogeneity in effects on zero to worst off</h3>
<div class="sourceCode" id="cb45"><pre class="downlit">
<span class="kw">h2_1</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">zero_to_worst_off</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span>  <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, 
                      data=<span class="kw">.</span> )
<span class="kw">h2_2</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">zero_to_worst_off</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span>  <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">leftp</span>, data=<span class="kw">.</span> )
<span class="kw">h2_3</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">zero_to_worst_off</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span>  <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">female</span> , data=<span class="kw">.</span> )
<span class="kw">h2_4</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">zero_to_worst_off</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span>  <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">age_h</span>, data=<span class="kw">.</span> )
<span class="kw">h2_5</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">zero_to_worst_off</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span>  <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">crt_h</span>, data=<span class="kw">.</span> )
<span class="kw">h2_6</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">zero_to_worst_off</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span>  <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">university</span>, data=<span class="kw">.</span> )
<span class="kw">h2_7</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">zero_to_worst_off</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span>  <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">high_income</span>, data=<span class="kw">.</span> )
<span class="kw">h2_8</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">zero_to_worst_off</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">leftp</span>  <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> <span class="op">+</span>
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">leftp</span> <span class="op">+</span> <span class="kw">choice</span><span class="op">*</span><span class="kw">female</span> <span class="op">+</span> <span class="kw">choice</span><span class="op">*</span><span class="kw">age_h</span> <span class="op">+</span> <span class="kw">choice</span><span class="op">*</span><span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">choice</span><span class="op">*</span><span class="kw">university</span> <span class="op">+</span> 
                        <span class="kw">choice</span><span class="op">*</span><span class="kw">high_income</span>, data=<span class="kw">.</span> )
</pre></div>
<p>Want to include linear combinations for the columns 2-7:</p>
<div class="sourceCode" id="cb46"><pre class="downlit">
<span class="kw">dh2</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">h2_2</span>, linfct=<span class="st">"choiceTRUE + choiceTRUE:leftpTRUE = 0"</span>, 
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">h2_2</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))
<span class="kw">dh3</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">h2_3</span>, linfct=<span class="st">"choiceTRUE + choiceTRUE:femaleTRUE = 0"</span>, 
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">h2_3</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))
<span class="kw">dh4</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">h2_4</span>, linfct=<span class="st">"choiceTRUE + choiceTRUE:age_hTRUE = 0"</span>, 
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">h2_4</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))
<span class="kw">dh5</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">h2_5</span>, linfct=<span class="st">"choiceTRUE + choiceTRUE:crt_hTRUE = 0"</span>, 
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">h2_5</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))
<span class="kw">dh6</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">h2_6</span>, linfct=<span class="st">"choiceTRUE + choiceTRUE:universityTRUE = 0"</span>, 
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">h2_6</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))
<span class="kw">dh7</span> <span class="op">&lt;-</span> <span class="fu">glht</span>(<span class="kw">h2_7</span>, linfct=<span class="st">"choiceTRUE + choiceTRUE:high_incomeTRUE = 0"</span>, 
             vcov = <span class="fu">cluster.vcov</span>(<span class="kw">h2_7</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))
<span class="kw">rh1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Linear combination"</span>,<span class="st">" "</span>, 
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">dh2</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">coefficients</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">dh3</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">coefficients</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">dh4</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">coefficients</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">dh5</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">coefficients</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">dh6</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">coefficients</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">dh7</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">coefficients</span>[<span class="fl">1</span>]),
        <span class="st">""</span>)
<span class="kw">rh2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>,<span class="st">""</span>,
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"(%4.3f)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">dh2</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">sigma</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"(%4.3f)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">dh3</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">sigma</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"(%4.3f)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">dh4</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">sigma</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"(%4.3f)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">dh5</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">sigma</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"(%4.3f)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">dh6</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">sigma</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"(%4.3f)"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">dh7</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">sigma</span>[<span class="fl">1</span>]),
        <span class="st">""</span>)
<span class="kw">rh3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>, <span class="st">""</span>,
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"p=%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">dh2</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalues</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"p=%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">dh3</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalues</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"p=%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">dh4</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalues</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"p=%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">dh5</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalues</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"p=%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">dh6</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalues</span>[<span class="fl">1</span>]),
        <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"p=%4.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">dh7</span>)<span class="op">$</span><span class="kw">test</span><span class="op">$</span><span class="kw">pvalues</span>[<span class="fl">1</span>]),
        <span class="st">""</span>)
</pre></div>
<p>Now for table output with p-values:</p>
<div class="sourceCode" id="cb47"><pre class="downlit">
<span class="fu">stargazer</span>( <span class="kw">h2_1</span>, <span class="kw">h2_2</span>, <span class="kw">h2_3</span>, <span class="kw">h2_4</span>, <span class="kw">h2_5</span>, <span class="kw">h2_6</span>, <span class="kw">h2_7</span>, <span class="kw">h2_8</span>,
           se = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>( <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">h2_1</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">h2_1</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">h2_2</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">h2_2</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">h2_3</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">h2_3</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">h2_4</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">h2_4</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">h2_5</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">h2_5</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">h2_6</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">h2_6</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">h2_7</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">h2_7</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">h2_8</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">h2_8</span><span class="op">$</span><span class="kw">residuals</span>))))),
        order=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"choice"</span>,<span class="st">"choiceTRUE:leftp"</span>,<span class="st">"choiceTRUE:female"</span>, <span class="st">"choiceTRUE:age_h"</span>,
                <span class="st">"choiceTRUE:crt_h"</span>, <span class="st">"choiceTRUE:universityTRUE"</span>, <span class="st">"choiceTRUE:high_incomeTRUE"</span>),
        add.lines=<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">rh1</span>,<span class="kw">rh2</span>,<span class="kw">rh3</span>), 
        type=<span class="st">"text"</span>, style=<span class="st">"aer"</span>, df=<span class="fl">FALSE</span>, keep.stat=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"rsq"</span>,<span class="st">"n"</span>),
        p.auto=<span class="fl">TRUE</span>,
        star.char=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>, <span class="st">""</span>,<span class="st">""</span>), notes=<span class="st">""</span>, notes.append=<span class="fl">FALSE</span>, report=<span class="st">"vcsp"</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; ======================================================================================================</span>
<span class="co">#&gt;                                                       zero_to_worst_off                               </span>
<span class="co">#&gt;                           (1)       (2)       (3)       (4)       (5)       (6)       (7)       (8)   </span>
<span class="co">#&gt; ------------------------------------------------------------------------------------------------------</span>
<span class="co">#&gt; choice                   0.098     0.114     0.115     0.126     0.079     0.090     0.091     0.131  </span>
<span class="co">#&gt;                         (0.009)   (0.018)   (0.014)   (0.013)   (0.011)   (0.013)   (0.010)   (0.026) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; choiceTRUE:leftp                  -0.024                                                      -0.020  </span>
<span class="co">#&gt;                                   (0.021)                                                     (0.021) </span>
<span class="co">#&gt;                                  p = 0.258                                                   p = 0.341</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; choiceTRUE:female                           -0.035                                            -0.027  </span>
<span class="co">#&gt;                                             (0.018)                                           (0.019) </span>
<span class="co">#&gt;                                            p = 0.058                                         p = 0.166</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; choiceTRUE:age_h                                      -0.062                                  -0.060  </span>
<span class="co">#&gt;                                                       (0.018)                                 (0.019) </span>
<span class="co">#&gt;                                                      p = 0.001                               p = 0.002</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; choiceTRUE:crt_h                                                 0.042                         0.028  </span>
<span class="co">#&gt;                                                                 (0.019)                       (0.019) </span>
<span class="co">#&gt;                                                                p = 0.026                     p = 0.137</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; choiceTRUE:university                                                      0.013               0.009  </span>
<span class="co">#&gt;                                                                           (0.018)             (0.019) </span>
<span class="co">#&gt;                                                                          p = 0.472           p = 0.624</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; choiceTRUE:high_income                                                               0.020     0.006  </span>
<span class="co">#&gt;                                                                                     (0.021)   (0.022) </span>
<span class="co">#&gt;                                                                                    p = 0.337 p = 0.788</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; leftp                   -0.046    -0.028    -0.047    -0.047    -0.046    -0.046    -0.046    -0.032  </span>
<span class="co">#&gt;                         (0.011)   (0.017)   (0.011)   (0.011)   (0.011)   (0.011)   (0.011)   (0.017) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.092 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.059</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; crt_h                    0.052     0.052     0.052     0.052     0.021     0.052     0.052     0.031  </span>
<span class="co">#&gt;                         (0.010)   (0.010)   (0.010)   (0.010)   (0.015)   (0.010)   (0.010)   (0.015) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.167 p = 0.000 p = 0.000 p = 0.036</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; female                  -0.044    -0.044    -0.017    -0.044    -0.044    -0.044    -0.043    -0.025  </span>
<span class="co">#&gt;                         (0.010)   (0.010)   (0.015)   (0.010)   (0.010)   (0.010)   (0.010)   (0.015) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.000 p = 0.234 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.098</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; age_h                   -0.058    -0.059    -0.059    -0.012    -0.058    -0.058    -0.058    -0.014  </span>
<span class="co">#&gt;                         (0.009)   (0.009)   (0.009)   (0.014)   (0.009)   (0.009)   (0.009)   (0.015) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.000 p = 0.000 p = 0.410 p = 0.000 p = 0.000 p = 0.000 p = 0.322</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; university               0.021     0.021     0.021     0.022     0.021     0.012     0.021     0.015  </span>
<span class="co">#&gt;                         (0.010)   (0.010)   (0.010)   (0.010)   (0.010)   (0.015)   (0.010)   (0.014) </span>
<span class="co">#&gt;                        p = 0.029 p = 0.029 p = 0.028 p = 0.025 p = 0.029 p = 0.428 p = 0.028 p = 0.303</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; high_income              0.049     0.049     0.048     0.048     0.049     0.049     0.034     0.043  </span>
<span class="co">#&gt;                         (0.011)   (0.011)   (0.011)   (0.011)   (0.011)   (0.011)   (0.017)   (0.017) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.049 p = 0.013</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; Constant                 0.110     0.098     0.098     0.090     0.125     0.116     0.116     0.087  </span>
<span class="co">#&gt;                         (0.014)   (0.017)   (0.016)   (0.015)   (0.015)   (0.016)   (0.014)   (0.021) </span>
<span class="co">#&gt;                        p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; Linear combination                 0.090     0.080     0.063     0.121     0.103     0.111            </span>
<span class="co">#&gt;                                   (0.011)   (0.012)   (0.013)   (0.015)   (0.013)   (0.018)           </span>
<span class="co">#&gt;                                   p=0.000   p=0.000   p=0.000   p=0.000   p=0.000   p=0.000           </span>
<span class="co">#&gt; Observations             5,757     5,757     5,757     5,757     5,757     5,757     5,757     5,757  </span>
<span class="co">#&gt; R2                       0.046     0.046     0.046     0.047     0.046     0.046     0.046     0.048  </span>
<span class="co">#&gt; ------------------------------------------------------------------------------------------------------</span>
<span class="co">#&gt; Notes:</span>
</pre></div>
<p>Want to output also to latex table.</p>
</div>
</div>
<div id="absolutely-no-effect-on-any-party" class="section level2">
<h2 class="hasAnchor">
<a href="#absolutely-no-effect-on-any-party" class="anchor"></a>Absolutely no effect on any party?</h2>
<p>In the lab experiment, we found a strong interaction between political affiliation and treatment. Are there really no interactions of choice and political preference in the representative sample? Let us try to run the treatment regressions party-by-party:</p>
<div id="treatment-effects-by-political-party" class="section level3">
<h3 class="hasAnchor">
<a href="#treatment-effects-by-political-party" class="anchor"></a>Treatment effects by political party</h3>
<p>On inequality:</p>
<div class="sourceCode" id="cb48"><pre class="downlit">
<span class="kw">rAp</span> <span class="op">&lt;-</span><span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">stortingsvalg</span><span class="op">==</span><span class="st">"Ap"</span>) <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span><span class="op">~</span><span class="kw">choice</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span>)
<span class="kw">rFrp</span> <span class="op">&lt;-</span><span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">stortingsvalg</span><span class="op">==</span><span class="st">"Frp"</span>) <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span><span class="op">~</span><span class="kw">choice</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span>)
<span class="kw">rH</span> <span class="op">&lt;-</span><span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">stortingsvalg</span><span class="op">==</span><span class="st">"H"</span>) <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span><span class="op">~</span><span class="kw">choice</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span>)
<span class="kw">rKrF</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">stortingsvalg</span><span class="op">==</span><span class="st">"KrF"</span>) <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span><span class="op">~</span><span class="kw">choice</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span>)
<span class="kw">rMDG</span> <span class="op">&lt;-</span><span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">stortingsvalg</span><span class="op">==</span><span class="st">"MDG"</span>) <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span><span class="op">~</span><span class="kw">choice</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span>)
<span class="kw">rR</span> <span class="op">&lt;-</span><span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">stortingsvalg</span><span class="op">==</span><span class="st">"R"</span>) <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span><span class="op">~</span><span class="kw">choice</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span>)
<span class="kw">rSp</span> <span class="op">&lt;-</span><span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">stortingsvalg</span><span class="op">==</span><span class="st">"Sp"</span>) <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span><span class="op">~</span><span class="kw">choice</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span>)
<span class="kw">rSV</span> <span class="op">&lt;-</span><span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">stortingsvalg</span><span class="op">==</span><span class="st">"SV"</span>) <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span><span class="op">~</span><span class="kw">choice</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span>)
<span class="kw">rV</span> <span class="op">&lt;-</span><span class="kw">df_k</span><span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">stortingsvalg</span><span class="op">==</span><span class="st">"V"</span>) <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span><span class="op">~</span><span class="kw">choice</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span>)

<span class="fu">stargazer</span>( <span class="kw">rR</span>, <span class="kw">rSV</span>, <span class="kw">rMDG</span>, <span class="kw">rAp</span>, <span class="kw">rSp</span>, <span class="kw">rKrF</span>, <span class="kw">rV</span>, <span class="kw">rH</span>, <span class="kw">rFrp</span>,
           se = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">rR</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">rR</span><span class="op">$</span><span class="kw">residuals</span>)))),
                     <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">rSV</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">rSV</span><span class="op">$</span><span class="kw">residuals</span>)))),
                     <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">rMDG</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">rMDG</span><span class="op">$</span><span class="kw">residuals</span>)))),
                     <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">rAp</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">rAp</span><span class="op">$</span><span class="kw">residuals</span>)))),
                     <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">rSp</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">rSp</span><span class="op">$</span><span class="kw">residuals</span>)))),
                     <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">rKrF</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">rKrF</span><span class="op">$</span><span class="kw">residuals</span>)))),
                     <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">rV</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">rV</span><span class="op">$</span><span class="kw">residuals</span>)))),
                     <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">rH</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">rH</span><span class="op">$</span><span class="kw">residuals</span>)))),
                     <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">rFrp</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">rFrp</span><span class="op">$</span><span class="kw">residuals</span>))))),
           column.labels=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"R"</span>,<span class="st">"SV"</span>,<span class="st">"MDG"</span>,<span class="st">"Ap"</span>,<span class="st">"Sp"</span>,<span class="st">"KrF"</span>,<span class="st">"V"</span>,<span class="st">"H"</span>,<span class="st">"Frp"</span>),
           star.char=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>, <span class="st">""</span>,<span class="st">""</span>), notes=<span class="st">""</span>, notes.append=<span class="fl">FALSE</span>, report=<span class="st">"vcsp"</span>,
           type=<span class="st">"text"</span>,  style=<span class="st">"aer"</span>, df=<span class="fl">FALSE</span>, keep.stat=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"rsq"</span>,<span class="st">"n"</span>))
<span class="co">#&gt; </span>
<span class="co">#&gt; ======================================================================================================</span>
<span class="co">#&gt;                                                     inequality                                        </span>
<span class="co">#&gt;                  R        SV        MDG       Ap        Sp        KrF        V         H        Frp   </span>
<span class="co">#&gt;                 (1)       (2)       (3)       (4)       (5)       (6)       (7)       (8)       (9)   </span>
<span class="co">#&gt; ------------------------------------------------------------------------------------------------------</span>
<span class="co">#&gt; choice         0.074     0.142     0.149     0.149     0.089     0.160     0.158     0.158     0.164  </span>
<span class="co">#&gt;               (0.050)   (0.038)   (0.055)   (0.019)   (0.047)   (0.053)   (0.042)   (0.023)   (0.035) </span>
<span class="co">#&gt;              p = 0.143 p = 0.001 p = 0.007 p = 0.000 p = 0.059 p = 0.003 p = 0.001 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; workp          0.049    -0.036    -0.062    -0.045    -0.083    -0.146    -0.035    -0.054    -0.097  </span>
<span class="co">#&gt;               (0.058)   (0.043)   (0.061)   (0.020)   (0.051)   (0.055)   (0.044)   (0.023)   (0.036) </span>
<span class="co">#&gt;              p = 0.402 p = 0.406 p = 0.310 p = 0.026 p = 0.103 p = 0.008 p = 0.429 p = 0.019 p = 0.008</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; female        -0.031    -0.063    -0.034    -0.086    -0.066    -0.098    -0.019    -0.097    -0.055  </span>
<span class="co">#&gt;               (0.066)   (0.042)   (0.059)   (0.020)   (0.048)   (0.054)   (0.047)   (0.023)   (0.037) </span>
<span class="co">#&gt;              p = 0.638 p = 0.129 p = 0.568 p = 0.000 p = 0.172 p = 0.071 p = 0.682 p = 0.000 p = 0.130</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; age_h         -0.038    -0.070    -0.056    -0.067    -0.079    -0.099     0.014    -0.110    -0.071  </span>
<span class="co">#&gt;               (0.065)   (0.040)   (0.063)   (0.020)   (0.047)   (0.050)   (0.045)   (0.022)   (0.033) </span>
<span class="co">#&gt;              p = 0.563 p = 0.082 p = 0.371 p = 0.001 p = 0.091 p = 0.048 p = 0.760 p = 0.000 p = 0.031</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; crt_h          0.053     0.011    -0.017     0.054    -0.038     0.045     0.194     0.074     0.086  </span>
<span class="co">#&gt;               (0.061)   (0.039)   (0.057)   (0.021)   (0.049)   (0.052)   (0.043)   (0.023)   (0.036) </span>
<span class="co">#&gt;              p = 0.382 p = 0.779 p = 0.761 p = 0.010 p = 0.437 p = 0.386 p = 0.000 p = 0.002 p = 0.018</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; university    -0.028    -0.022     0.076     0.014     0.014     0.076     0.011     0.027     0.070  </span>
<span class="co">#&gt;               (0.075)   (0.048)   (0.061)   (0.020)   (0.050)   (0.051)   (0.051)   (0.023)   (0.036) </span>
<span class="co">#&gt;              p = 0.709 p = 0.648 p = 0.214 p = 0.479 p = 0.785 p = 0.140 p = 0.829 p = 0.237 p = 0.049</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; high_income    0.111    -0.040     0.067     0.070     0.020     0.000     0.093     0.057     0.057  </span>
<span class="co">#&gt;               (0.071)   (0.043)   (0.068)   (0.022)   (0.056)   (0.064)   (0.048)   (0.024)   (0.037) </span>
<span class="co">#&gt;              p = 0.117 p = 0.351 p = 0.324 p = 0.002 p = 0.727 p = 0.995 p = 0.052 p = 0.018 p = 0.123</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; Constant       0.064     0.194     0.107     0.169     0.317     0.270    -0.001     0.255     0.215  </span>
<span class="co">#&gt;               (0.086)   (0.060)   (0.089)   (0.030)   (0.072)   (0.077)   (0.067)   (0.035)   (0.049) </span>
<span class="co">#&gt;              p = 0.457 p = 0.002 p = 0.232 p = 0.000 p = 0.000 p = 0.001 p = 0.988 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                       </span>
<span class="co">#&gt; Observations    112       293       158      1,340      236       194       293      1,229      547   </span>
<span class="co">#&gt; R2             0.063     0.055     0.055     0.081     0.042     0.128     0.126     0.098     0.087  </span>
<span class="co">#&gt; ------------------------------------------------------------------------------------------------------</span>
<span class="co">#&gt; Notes:</span>
</pre></div>
<p>Output to latex (silent):</p>
</div>
</div>
<div id="triple-interactions" class="section level2">
<h2 class="hasAnchor">
<a href="#triple-interactions" class="anchor"></a>Triple interactions</h2>
<p>We are interested in the possible triple interaction between political, left, and cognitive reflection.</p>
<div class="sourceCode" id="cb49"><pre class="downlit">
<span class="kw">triple1</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> , data=<span class="kw">.</span>)
<span class="kw">triple2</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">choice</span><span class="op">*</span><span class="kw">leftp</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span>)
<span class="kw">triple3</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">choice</span><span class="op">*</span><span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span> )
<span class="kw">triple4</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">choice</span><span class="op">*</span><span class="kw">leftp</span> <span class="op">+</span> <span class="kw">choice</span><span class="op">*</span><span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span>  <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> 
                           <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span> )
<span class="kw">triple5</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">choice</span><span class="op">*</span><span class="kw">leftp</span> <span class="op">+</span> <span class="kw">choice</span><span class="op">*</span><span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">leftp</span><span class="op">*</span><span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span>  
                           <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span><span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> , data=<span class="kw">.</span> )
<span class="kw">triple6</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">choice</span> <span class="op">+</span> <span class="kw">workp</span> <span class="op">+</span> <span class="kw">choice</span><span class="op">*</span><span class="kw">leftp</span> <span class="op">+</span> <span class="kw">choice</span><span class="op">*</span><span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">leftp</span><span class="op">*</span><span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">choice</span><span class="op">*</span><span class="kw">leftp</span><span class="op">*</span><span class="kw">crt_h</span> <span class="op">+</span> 
                           <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span>  <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span><span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span> )

<span class="fu">stargazer</span>(<span class="kw">triple1</span>, <span class="kw">triple2</span>, <span class="kw">triple3</span>, <span class="kw">triple4</span>, <span class="kw">triple5</span>, <span class="kw">triple6</span>,
          se = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">triple1</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))),
                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">triple2</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))),
                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">triple3</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))),
                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">triple4</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))),
                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">triple5</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>)))),
                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">triple6</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_k</span>))))),
        style=<span class="st">"aer"</span>, df=<span class="fl">FALSE</span>, keep.stat=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"rsq"</span>,<span class="st">"n"</span>), p.auto=<span class="fl">TRUE</span>,
         star.char=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>, <span class="st">""</span>,<span class="st">""</span>), notes=<span class="st">""</span>, notes.append=<span class="fl">FALSE</span>, report=<span class="st">"vcsp"</span>, type=<span class="st">"text"</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; ======================================================================================</span>
<span class="co">#&gt;                                                    inequality                         </span>
<span class="co">#&gt;                               (1)       (2)       (3)       (4)       (5)       (6)   </span>
<span class="co">#&gt; --------------------------------------------------------------------------------------</span>
<span class="co">#&gt; choice                       0.142     0.158     0.123     0.139     0.139     0.138  </span>
<span class="co">#&gt;                             (0.010)   (0.019)   (0.013)   (0.020)   (0.020)   (0.024) </span>
<span class="co">#&gt;                            p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                       </span>
<span class="co">#&gt; workp                       -0.060    -0.060    -0.060    -0.060    -0.059    -0.059  </span>
<span class="co">#&gt;                             (0.010)   (0.010)   (0.010)   (0.010)   (0.010)   (0.010) </span>
<span class="co">#&gt;                            p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                       </span>
<span class="co">#&gt; leftp                       -0.063    -0.046    -0.063    -0.046    -0.027    -0.028  </span>
<span class="co">#&gt;                             (0.011)   (0.018)   (0.011)   (0.018)   (0.020)   (0.023) </span>
<span class="co">#&gt;                            p = 0.000 p = 0.013 p = 0.000 p = 0.013 p = 0.183 p = 0.224</span>
<span class="co">#&gt;                                                                                       </span>
<span class="co">#&gt; crt_h                        0.059     0.059     0.026     0.026     0.055     0.054  </span>
<span class="co">#&gt;                             (0.010)   (0.010)   (0.017)   (0.017)   (0.023)   (0.032) </span>
<span class="co">#&gt;                            p = 0.000 p = 0.000 p = 0.118 p = 0.118 p = 0.018 p = 0.098</span>
<span class="co">#&gt;                                                                                       </span>
<span class="co">#&gt; female                      -0.084    -0.085    -0.084    -0.085    -0.085    -0.085  </span>
<span class="co">#&gt;                             (0.010)   (0.010)   (0.010)   (0.010)   (0.010)   (0.010) </span>
<span class="co">#&gt;                            p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                       </span>
<span class="co">#&gt; age_h                       -0.079    -0.079    -0.079    -0.079    -0.079    -0.079  </span>
<span class="co">#&gt;                             (0.010)   (0.010)   (0.010)   (0.010)   (0.010)   (0.010) </span>
<span class="co">#&gt;                            p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                       </span>
<span class="co">#&gt; university                   0.016     0.016     0.016     0.016     0.016     0.016  </span>
<span class="co">#&gt;                             (0.010)   (0.010)   (0.010)   (0.010)   (0.010)   (0.010) </span>
<span class="co">#&gt;                            p = 0.108 p = 0.109 p = 0.110 p = 0.112 p = 0.115 p = 0.116</span>
<span class="co">#&gt;                                                                                       </span>
<span class="co">#&gt; high_income                  0.050     0.050     0.050     0.050     0.050     0.050  </span>
<span class="co">#&gt;                             (0.011)   (0.011)   (0.011)   (0.011)   (0.011)   (0.011) </span>
<span class="co">#&gt;                            p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                       </span>
<span class="co">#&gt; choiceTRUE:leftp                      -0.023              -0.023    -0.023    -0.023  </span>
<span class="co">#&gt;                                       (0.022)             (0.022)   (0.022)   (0.028) </span>
<span class="co">#&gt;                                      p = 0.304           p = 0.302 p = 0.296 p = 0.424</span>
<span class="co">#&gt;                                                                                       </span>
<span class="co">#&gt; choiceTRUE:crt_h                                 0.043     0.043     0.044     0.045  </span>
<span class="co">#&gt;                                                 (0.020)   (0.020)   (0.020)   (0.039) </span>
<span class="co">#&gt;                                                p = 0.033 p = 0.033 p = 0.032 p = 0.248</span>
<span class="co">#&gt;                                                                                       </span>
<span class="co">#&gt; leftpTRUE:crt_h                                                     -0.042    -0.040  </span>
<span class="co">#&gt;                                                                     (0.022)   (0.038) </span>
<span class="co">#&gt;                                                                    p = 0.056 p = 0.286</span>
<span class="co">#&gt;                                                                                       </span>
<span class="co">#&gt; choiceTRUE:leftpTRUE:crt_h                                                    -0.002  </span>
<span class="co">#&gt;                                                                               (0.046) </span>
<span class="co">#&gt;                                                                              p = 0.965</span>
<span class="co">#&gt;                                                                                       </span>
<span class="co">#&gt; Constant                     0.264     0.253     0.279     0.268     0.254     0.255  </span>
<span class="co">#&gt;                             (0.016)   (0.020)   (0.017)   (0.020)   (0.021)   (0.023) </span>
<span class="co">#&gt;                            p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                       </span>
<span class="co">#&gt; Observations                 5,757     5,757     5,757     5,757     5,757     5,757  </span>
<span class="co">#&gt; R2                           0.081     0.081     0.082     0.082     0.082     0.082  </span>
<span class="co">#&gt; --------------------------------------------------------------------------------------</span>
<span class="co">#&gt; Notes:</span>
</pre></div>
<p>And also to latex (silent).</p>
</div>
</div>
<div id="understanding-mechanisms" class="section level1">
<h1 class="hasAnchor">
<a href="#understanding-mechanisms" class="anchor"></a>Understanding / Mechanisms</h1>
<p>We collected information of two types that we can use to get an idea of how participants thought about the experiment. 1. We asked those in “nominal choice” whether they believed “Var det like sannsynlig at deltakerne valgte fargen til den ballen som senere ble trukket” 2. We asked all “For du gjorde ditt valg tjente deltaker A 8 USD mens deltaker B tjente 0 USD pa”</p>
<div id="in-nominal-choice" class="section level2">
<h2 class="hasAnchor">
<a href="#in-nominal-choice" class="anchor"></a>In nominal choice</h2>
<p>A clear majority said “yes”, but some said I don’t know:</p>
<div class="sourceCode" id="cb50"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="kw">df_k</span><span class="op">$</span><span class="kw">understanding1</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;       Ja      Nei Vet ikke </span>
<span class="co">#&gt;     1190       97      150</span>
<span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">treatmentgroup</span><span class="op">==</span><span class="st">"Nominal Choice"</span>) <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x=<span class="kw">understanding1</span>, y = (<span class="kw">..count..</span>)<span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span>(<span class="kw">..count..</span>,<span class="kw">..PANEL..</span>,<span class="kw">sum</span>)[<span class="kw">..PANEL..</span>])) <span class="op">+</span>
  <span class="fu">geom_bar</span>(width=<span class="fl">0.7</span>) <span class="op">+</span> <span class="fu">theme_bw</span>() <span class="op">+</span> 
  <span class="fu">labs</span>(title= <span class="st">"Equally likely in nominal choice?"</span>,
                                x=<span class="st">""</span>, y = <span class="st">"Fraction"</span>)
</pre></div>
<p><img src="A-online-experiment_files/figure-html/unnamed-chunk-48-1.png" width="672"></p>
<p>Did those who didn’t understand distribute any differently than others?</p>
<div class="sourceCode" id="cb51"><pre class="downlit">
<span class="kw">u1</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">treatmentgroup</span> <span class="op">==</span> <span class="st">"Nominal Choice"</span>) <span class="op">%&gt;%</span> 
  <span class="kw">dplyr</span>::<span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="kw">understanding1</span>, <span class="kw">inequality</span>, <span class="kw">zero_to_worst_off</span>) <span class="op">%&gt;%</span>
  <span class="fu">gather</span>(<span class="kw">inequality</span>, <span class="kw">zero_to_worst_off</span>, key=<span class="st">"outcome"</span>, value=<span class="st">"y"</span>) <span class="op">%&gt;%</span>
  <span class="fu">mutate</span>(understand = <span class="fu">fct_recode</span>(<span class="kw">understanding1</span>,
                                 <span class="st">"Understand"</span> = <span class="st">"Ja"</span>,
                                 <span class="st">"Don't understand"</span> = <span class="st">"Nei"</span>,
                                 <span class="st">"Don't understand"</span> = <span class="st">"Vet ikke"</span>)) <span class="op">%&gt;%</span>
  <span class="fu">group_by</span>(<span class="kw">understand</span>, <span class="kw">outcome</span>) 
<span class="kw">u1</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarize</span>(mean_y = <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw">y</span>, na.rm=<span class="fl">TRUE</span>), se_y = <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="kw">y</span>, na.rm=<span class="fl">TRUE</span>)<span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu">n</span>())) <span class="op">%&gt;%</span>
  <span class="fu">mutate</span>(outcome = <span class="fu">fct_recode</span>(<span class="kw">outcome</span>,
                              <span class="st">"Inequality"</span> = <span class="st">"inequality"</span>, 
                              <span class="st">"Nothing to worse off"</span> = <span class="st">"zero_to_worst_off"</span>)) <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x=<span class="kw">understand</span>, y=<span class="kw">mean_y</span>)) <span class="op">+</span> <span class="fu">geom_bar</span>(stat=<span class="st">"identity"</span>, width=<span class="fl">0.7</span>) <span class="op">+</span> 
    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(ymax=<span class="kw">mean_y</span><span class="op">+</span><span class="kw">se_y</span>, ymin=<span class="kw">mean_y</span><span class="op">-</span><span class="kw">se_y</span>), width=<span class="fl">0.2</span>) <span class="op">+</span> 
  <span class="fu">facet_wrap</span>(<span class="op">~</span><span class="kw">outcome</span>, scales=<span class="st">"free"</span>) <span class="op">+</span>
  <span class="fu">xlab</span>(<span class="st">"Was the probability of winning equal in Nominal Choice situation?"</span>) <span class="op">+</span> 
  <span class="fu">ylab</span>(<span class="st">"Mean \u00B1 s.e.m."</span>) <span class="op">+</span> <span class="fu">theme_bw</span>()
<span class="co">#&gt; `summarise()` regrouping output by 'understand' (override with `.groups` argument)</span>
</pre></div>
<p><img src="A-online-experiment_files/figure-html/unnamed-chunk-49-1.png" width="672"></p>
<p>Are these differences significant?</p>
<div class="sourceCode" id="cb52"><pre class="downlit">
<span class="kw">u1</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">outcome</span><span class="op">==</span><span class="st">"inequality"</span>) <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span>(<span class="kw">y</span> <span class="op">~</span> <span class="kw">understand</span>, data=<span class="kw">.</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Welch Two Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  y by understand</span>
<span class="co">#&gt; t = 1.2594, df = 368.39, p-value = 0.2087</span>
<span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -0.01775029  0.08098558</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;       mean in group Understand mean in group Don't understand </span>
<span class="co">#&gt;                      0.2816176                      0.2500000</span>
<span class="kw">u1</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">outcome</span><span class="op">==</span><span class="st">"inequality"</span>) <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span>(<span class="kw">y</span> <span class="op">~</span> <span class="kw">understand</span>, data=<span class="kw">.</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Wilcoxon rank sum test with continuity correction</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  y by understand</span>
<span class="co">#&gt; W = 152685, p-value = 0.2824</span>
<span class="co">#&gt; alternative hypothesis: true location shift is not equal to 0</span>

<span class="kw">u1z</span> <span class="op">&lt;-</span> <span class="kw">u1</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">outcome</span><span class="op">==</span><span class="st">"zero_to_worst_off"</span>) <span class="op">%&gt;%</span> 
  <span class="fu">group_by</span>(<span class="kw">understand</span>, <span class="kw">y</span>) <span class="op">%&gt;%</span> 
  <span class="fu">summarize</span>(n=<span class="fu">n</span>()) <span class="op">%&gt;%</span> 
  <span class="fu">spread</span>(key=<span class="kw">understand</span>, value=<span class="kw">n</span>) <span class="op">%&gt;%</span> 
  <span class="kw">dplyr</span>::<span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span><span class="kw">y</span>) 
<span class="co">#&gt; `summarise()` regrouping output by 'understand' (override with `.groups` argument)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="kw">u1z</span>))
<span class="co">#&gt; </span>
<span class="co">#&gt;  2-sample test for equality of proportions with continuity correction</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  as.matrix(u1z)</span>
<span class="co">#&gt; X-squared = 1.2825, df = 1, p-value = 0.2574</span>
<span class="co">#&gt; alternative hypothesis: two.sided</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -0.08815484  0.01977077</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;    prop 1    prop 2 </span>
<span class="co">#&gt; 0.8229508 0.8571429</span>
</pre></div>
</div>
<div id="control-over-earnings-before-distribution-choice" class="section level2">
<h2 class="hasAnchor">
<a href="#control-over-earnings-before-distribution-choice" class="anchor"></a>Control over earnings before distribution choice</h2>
<p>We asked whether the two participants had any control over their own earnings before the DM made their choices.</p>
<div class="sourceCode" id="cb53"><pre class="downlit">
<span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="kw">understanding2n</span>)) <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x=<span class="kw">understanding2n</span>, y = (<span class="kw">..count..</span>)<span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span>(<span class="kw">..count..</span>,<span class="kw">..PANEL..</span>,<span class="kw">sum</span>)[<span class="kw">..PANEL..</span>])) <span class="op">+</span> 
  <span class="fu">geom_bar</span>(width=<span class="fl">0.7</span>) <span class="op">+</span> 
  <span class="fu">facet_wrap</span>(<span class="op">~</span><span class="kw">treatmentgroup</span>) <span class="op">+</span> <span class="fu">theme_bw</span>() <span class="op">+</span> 
  <span class="fu">labs</span>(x=<span class="st">"Answer from 1-7. (1: no control, ..., 7: full control)"</span>, y = <span class="st">"Fraction"</span>) <span class="op">+</span>
  <span class="fu">scale_x_discrete</span>(limits=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span>))
<span class="co">#&gt; Warning: Continuous limits supplied to discrete scale.</span>
<span class="co">#&gt; Did you mean `limits = factor(...)` or `scale_*_continuous()`?</span>
</pre></div>
<p><img src="A-online-experiment_files/figure-html/unnamed-chunk-51-1.png" width="672"></p>
<div class="sourceCode" id="cb54"><pre class="downlit">
<span class="fu">ggsave</span>(<span class="fu">here</span>(<span class="st">"graphs"</span>, <span class="st">"control_earnings.pdf"</span>))
<span class="co">#&gt; Saving 7 x 4.5 in image</span>
</pre></div>
<p>What are the exact shares at “no control”?</p>
<div class="sourceCode" id="cb55"><pre class="downlit">
<span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span>(<span class="kw">treatmentgroup</span>) <span class="op">%&gt;%</span> 
  <span class="fu">summarize</span>(share_no_control = <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>( (<span class="kw">understanding2n</span><span class="op">==</span><span class="fl">1</span>), na.rm=<span class="fl">TRUE</span>),
                                           n = <span class="fu">n</span>()) <span class="op">%&gt;%</span> <span class="kw">knitr</span>::<span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(digits=<span class="fl">3</span>)
<span class="co">#&gt; `summarise()` ungrouping output (override with `.groups` argument)</span>
</pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">treatmentgroup</th>
<th align="right">share_no_control</th>
<th align="right">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Base</td>
<td align="right">0.823</td>
<td align="right">1456</td>
</tr>
<tr class="even">
<td align="left">Forced Choice</td>
<td align="right">0.603</td>
<td align="right">2864</td>
</tr>
<tr class="odd">
<td align="left">Nominal Choice</td>
<td align="right">0.819</td>
<td align="right">1437</td>
</tr>
</tbody>
</table>
<p>Are these differences significant?</p>
<div class="sourceCode" id="cb56"><pre class="downlit">
<span class="kw">c1</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span>  <span class="fu">group_by</span>(<span class="kw">treatmentgroup</span>) <span class="op">%&gt;%</span> <span class="fu">summarize</span>( no_control = <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">inequality</span> <span class="op">==</span> <span class="fl">1</span>), n=<span class="fu">n</span>())
<span class="co">#&gt; `summarise()` ungrouping output (override with `.groups` argument)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span>(<span class="kw">c1</span><span class="op">$</span><span class="kw">no_control</span>, <span class="kw">c1</span><span class="op">$</span><span class="kw">n</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  3-sample test for equality of proportions without continuity</span>
<span class="co">#&gt;  correction</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  c1$no_control out of c1$n</span>
<span class="co">#&gt; X-squared = 98.682, df = 2, p-value &lt; 2.2e-16</span>
<span class="co">#&gt; alternative hypothesis: two.sided</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;     prop 1     prop 2     prop 3 </span>
<span class="co">#&gt; 0.08379121 0.20006983 0.15100905</span>
</pre></div>
<p>Also by treatmentgroup (excluding “strong” and “very strong”):</p>
<div class="sourceCode" id="cb57"><pre class="downlit">
<span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span>(<span class="kw">treatmentgroup</span>) <span class="op">%&gt;%</span> 
  <span class="fu">summarize</span>(share_no_control = <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>( (<span class="kw">understanding2n</span><span class="op">==</span><span class="fl">1</span>), na.rm=<span class="fl">TRUE</span>),
                                           n = <span class="fu">n</span>()) <span class="op">%&gt;%</span> <span class="kw">knitr</span>::<span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(digits=<span class="fl">3</span>)
<span class="co">#&gt; `summarise()` ungrouping output (override with `.groups` argument)</span>
</pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">treatmentgroup</th>
<th align="right">share_no_control</th>
<th align="right">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Base</td>
<td align="right">0.823</td>
<td align="right">1456</td>
</tr>
<tr class="even">
<td align="left">Forced Choice</td>
<td align="right">0.603</td>
<td align="right">2864</td>
</tr>
<tr class="odd">
<td align="left">Nominal Choice</td>
<td align="right">0.819</td>
<td align="right">1437</td>
</tr>
</tbody>
</table>
<div id="mediation" class="section level3">
<h3 class="hasAnchor">
<a href="#mediation" class="anchor"></a>Mediation …</h3>
<p>Can we explain understanding with treatmentgroup? And does understanding knock out the treatment efects?</p>
<div class="sourceCode" id="cb58"><pre class="downlit">
<span class="kw">dfmainu2</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="kw">understanding2n</span>))
<span class="kw">ru2_1</span> <span class="op">&lt;-</span> <span class="kw">dfmainu2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">understanding2n</span> <span class="op">~</span> <span class="kw">treatmentgroup</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span>
                           <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span> , data=<span class="kw">.</span>)
<span class="kw">ru2_2</span> <span class="op">&lt;-</span> <span class="kw">dfmainu2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">treatmentgroup</span> <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span>
                           <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span>)
<span class="kw">ru2_3</span> <span class="op">&lt;-</span> <span class="kw">dfmainu2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">treatmentgroup</span> <span class="op">+</span> <span class="kw">understanding2n</span>  <span class="op">+</span> <span class="kw">leftp</span> <span class="op">+</span> 
                           <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span>)
<span class="kw">ru2_4</span> <span class="op">&lt;-</span> <span class="kw">dfmainu2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">treatmentgroup</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw">understanding2n</span>) <span class="op">+</span> 
                           <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span>)
<span class="kw">ru2_5</span> <span class="op">&lt;-</span> <span class="kw">dfmainu2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">zero_to_worst_off</span> <span class="op">~</span> <span class="kw">treatmentgroup</span> <span class="op">+</span>  <span class="kw">leftp</span> <span class="op">+</span> 
                           <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span>)
<span class="kw">ru2_6</span> <span class="op">&lt;-</span> <span class="kw">dfmainu2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">zero_to_worst_off</span> <span class="op">~</span> <span class="kw">treatmentgroup</span> <span class="op">+</span> <span class="kw">understanding2n</span> <span class="op">+</span> 
                           <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span>)
<span class="kw">ru2_7</span> <span class="op">&lt;-</span> <span class="kw">dfmainu2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">zero_to_worst_off</span> <span class="op">~</span> <span class="kw">treatmentgroup</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="kw">understanding2n</span>) <span class="op">+</span> 
                           <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span> <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>,  data=<span class="kw">.</span>)

<span class="fu">stargazer</span>( <span class="kw">ru2_1</span>, <span class="kw">ru2_2</span>, <span class="kw">ru2_3</span>, <span class="kw">ru2_4</span>, <span class="kw">ru2_5</span>, <span class="kw">ru2_6</span>, <span class="kw">ru2_7</span>,
           se = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>( <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">ru2_1</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">ru2_1</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">ru2_2</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">ru2_2</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">ru2_3</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">ru2_3</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">ru2_4</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">ru2_4</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">ru2_5</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">ru2_5</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">ru2_6</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">ru2_6</span><span class="op">$</span><span class="kw">residuals</span>)))),
                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">ru2_7</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw">ru2_7</span><span class="op">$</span><span class="kw">residuals</span>))))),
           type=<span class="st">"text"</span>, style=<span class="st">"aer"</span>, df=<span class="fl">FALSE</span>, keep.stat=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"rsq"</span>,<span class="st">"n"</span>),
           star.char=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>, <span class="st">""</span>,<span class="st">""</span>), notes=<span class="st">""</span>, notes.append=<span class="fl">FALSE</span>, report=<span class="st">"vcsp"</span>, header=<span class="fl">FALSE</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; ========================================================================================================</span>
<span class="co">#&gt;                              understanding2n          inequality                 zero_to_worst_off      </span>
<span class="co">#&gt;                                    (1)          (2)       (3)       (4)       (5)       (6)       (7)   </span>
<span class="co">#&gt; --------------------------------------------------------------------------------------------------------</span>
<span class="co">#&gt; treatmentgroupForced Choice       0.724        0.150     0.131     0.132     0.119     0.103     0.106  </span>
<span class="co">#&gt;                                  (0.052)      (0.011)   (0.011)   (0.012)   (0.011)   (0.011)   (0.011) </span>
<span class="co">#&gt;                                 p = 0.000    p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                         </span>
<span class="co">#&gt; treatmentgroupNominal Choice      0.019        0.114     0.114     0.114     0.072     0.072     0.072  </span>
<span class="co">#&gt;                                  (0.052)      (0.013)   (0.013)   (0.013)   (0.012)   (0.012)   (0.012) </span>
<span class="co">#&gt;                                 p = 0.716    p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                         </span>
<span class="co">#&gt; understanding2n                                          0.027                         0.021            </span>
<span class="co">#&gt;                                                         (0.003)                       (0.003)           </span>
<span class="co">#&gt;                                                        p = 0.000                     p = 0.000          </span>
<span class="co">#&gt;                                                                                                         </span>
<span class="co">#&gt; factor(understanding2n)2                                          -0.002                        -0.036  </span>
<span class="co">#&gt;                                                                   (0.020)                       (0.019) </span>
<span class="co">#&gt;                                                                  p = 0.909                     p = 0.059</span>
<span class="co">#&gt;                                                                                                         </span>
<span class="co">#&gt; factor(understanding2n)3                                           0.028                        -0.003  </span>
<span class="co">#&gt;                                                                   (0.021)                       (0.021) </span>
<span class="co">#&gt;                                                                  p = 0.194                     p = 0.900</span>
<span class="co">#&gt;                                                                                                         </span>
<span class="co">#&gt; factor(understanding2n)4                                           0.061                         0.046  </span>
<span class="co">#&gt;                                                                   (0.021)                       (0.021) </span>
<span class="co">#&gt;                                                                  p = 0.004                     p = 0.026</span>
<span class="co">#&gt;                                                                                                         </span>
<span class="co">#&gt; factor(understanding2n)5                                           0.124                         0.103  </span>
<span class="co">#&gt;                                                                   (0.037)                       (0.039) </span>
<span class="co">#&gt;                                                                  p = 0.001                     p = 0.009</span>
<span class="co">#&gt;                                                                                                         </span>
<span class="co">#&gt; factor(understanding2n)6                                           0.280                         0.217  </span>
<span class="co">#&gt;                                                                   (0.062)                       (0.072) </span>
<span class="co">#&gt;                                                                  p = 0.000                     p = 0.003</span>
<span class="co">#&gt;                                                                                                         </span>
<span class="co">#&gt; factor(understanding2n)7                                           0.157                         0.130  </span>
<span class="co">#&gt;                                                                   (0.024)                       (0.025) </span>
<span class="co">#&gt;                                                                  p = 0.000                     p = 0.000</span>
<span class="co">#&gt;                                                                                                         </span>
<span class="co">#&gt; leftp                            -0.010       -0.066    -0.065    -0.065    -0.049    -0.049    -0.048  </span>
<span class="co">#&gt;                                  (0.050)      (0.011)   (0.011)   (0.011)   (0.011)   (0.011)   (0.011) </span>
<span class="co">#&gt;                                 p = 0.846    p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                         </span>
<span class="co">#&gt; female                           -0.217       -0.082    -0.076    -0.076    -0.041    -0.037    -0.037  </span>
<span class="co">#&gt;                                  (0.047)      (0.010)   (0.010)   (0.010)   (0.010)   (0.010)   (0.010) </span>
<span class="co">#&gt;                                 p = 0.000    p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.001 p = 0.001</span>
<span class="co">#&gt;                                                                                                         </span>
<span class="co">#&gt; age_h                            -0.431       -0.079    -0.067    -0.069    -0.056    -0.047    -0.050  </span>
<span class="co">#&gt;                                  (0.045)      (0.010)   (0.010)   (0.010)   (0.010)   (0.010)   (0.010) </span>
<span class="co">#&gt;                                 p = 0.000    p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                         </span>
<span class="co">#&gt; crt_h                            -0.121        0.059     0.062     0.062     0.054     0.056     0.056  </span>
<span class="co">#&gt;                                  (0.047)      (0.010)   (0.010)   (0.010)   (0.010)   (0.010)   (0.010) </span>
<span class="co">#&gt;                                 p = 0.010    p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                         </span>
<span class="co">#&gt; university                        0.081        0.019     0.017     0.017     0.023     0.022     0.022  </span>
<span class="co">#&gt;                                  (0.047)      (0.010)   (0.010)   (0.010)   (0.010)   (0.010)   (0.010) </span>
<span class="co">#&gt;                                 p = 0.085    p = 0.062 p = 0.095 p = 0.092 p = 0.021 p = 0.032 p = 0.029</span>
<span class="co">#&gt;                                                                                                         </span>
<span class="co">#&gt; high_income                       0.051        0.048     0.047     0.046     0.049     0.048     0.047  </span>
<span class="co">#&gt;                                  (0.050)      (0.011)   (0.011)   (0.011)   (0.011)   (0.011)   (0.011) </span>
<span class="co">#&gt;                                 p = 0.309    p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                         </span>
<span class="co">#&gt; Constant                          1.821        0.231     0.182     0.212     0.107     0.067     0.094  </span>
<span class="co">#&gt;                                  (0.070)      (0.016)   (0.017)   (0.016)   (0.015)   (0.016)   (0.015) </span>
<span class="co">#&gt;                                 p = 0.000    p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                                         </span>
<span class="co">#&gt; Observations                      5,503        5,503     5,503     5,503     5,503     5,503     5,503  </span>
<span class="co">#&gt; R2                                0.066        0.077     0.091     0.093     0.049     0.058     0.061  </span>
<span class="co">#&gt; --------------------------------------------------------------------------------------------------------</span>
<span class="co">#&gt; Notes:</span>
</pre></div>
<p>Also to latex (silent):</p>
<p>We see that treatment does have a sizable effect on understanding, but that the effects of choice remains strong even when controlling for the level of understanding. This does not depend on how the understanding is added linearly (as seen by comparing column 3 vs 4, and 6 vs 7).</p>
<p>We see that the total number of observations is lower than in the main regressions. This is because some respondents chose the “don’t know” option, and these don’t enter the regressions (or the graph above). The proportion that choice the “don’t know” option was not much different by treatment:</p>
<div class="sourceCode" id="cb59"><pre class="downlit">
<span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span>(<span class="kw">treatment</span>) <span class="op">%&gt;%</span> <span class="fu">summarize</span>(share_dont_know = <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw">understanding2</span><span class="op">==</span><span class="st">"Vet ikke"</span>)) <span class="op">%&gt;%</span>
  <span class="kw">knitr</span>::<span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(digits=<span class="fl">3</span>)
<span class="co">#&gt; `summarise()` ungrouping output (override with `.groups` argument)</span>
</pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">treatment</th>
<th align="right">share_dont_know</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Base (w)</td>
<td align="right">0.052</td>
</tr>
<tr class="even">
<td align="left">Forced Choice (w)</td>
<td align="right">0.042</td>
</tr>
<tr class="odd">
<td align="left">Nominal Choice (w)</td>
<td align="right">0.034</td>
</tr>
<tr class="even">
<td align="left">Base (nw)</td>
<td align="right">0.051</td>
</tr>
<tr class="odd">
<td align="left">Forced Choice (nw)</td>
<td align="right">0.046</td>
</tr>
<tr class="even">
<td align="left">Nominal Choice (nw)</td>
<td align="right">0.044</td>
</tr>
</tbody>
</table>
</div>
<div id="restricting-to-those-that-were-not-confused" class="section level3">
<h3 class="hasAnchor">
<a href="#restricting-to-those-that-were-not-confused" class="anchor"></a>Restricting to those that were not confused</h3>
<p>Can we still find the main treatmentgroup if we exclude all those who are in doubt about the workers not having control? Let’s re-estimate the main table for the representative sample on the subset of people who are absoluteley sure.</p>
<div class="sourceCode" id="cb60"><pre class="downlit">
<span class="kw">df_c</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">understanding2n</span><span class="op">==</span><span class="fl">1</span>)

<span class="kw">cineq_1</span> <span class="op">&lt;-</span>  <span class="kw">df_c</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">treatmentgroup</span> , data = <span class="kw">.</span> )
<span class="kw">cineq_2</span> <span class="op">&lt;-</span>  <span class="kw">df_c</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">treatmentgroup</span>  <span class="op">+</span>
                             <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span>, data=<span class="kw">.</span>)
<span class="kw">cineq_3</span> <span class="op">&lt;-</span>  <span class="kw">df_c</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">inequality</span> <span class="op">~</span> <span class="kw">treatmentgroup</span>  <span class="op">+</span>
                             <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span>
                             <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span>)

<span class="kw">cnoth_1</span> <span class="op">&lt;-</span>  <span class="kw">df_c</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>( <span class="kw">zero_to_worst_off</span> <span class="op">~</span> <span class="kw">treatmentgroup</span>  , data = <span class="kw">.</span> )
<span class="kw">cnoth_2</span>  <span class="op">&lt;-</span> <span class="kw">df_c</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>( <span class="kw">zero_to_worst_off</span> <span class="op">~</span> <span class="kw">treatmentgroup</span> <span class="op">+</span>
                              <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span>, data=<span class="kw">.</span>)
<span class="kw">cnoth_3</span>  <span class="op">&lt;-</span> <span class="kw">df_c</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>( <span class="kw">zero_to_worst_off</span> <span class="op">~</span> <span class="kw">treatmentgroup</span> <span class="op">+</span>
                              <span class="kw">leftp</span> <span class="op">+</span> <span class="kw">female</span> <span class="op">+</span> <span class="kw">age_h</span> <span class="op">+</span> <span class="kw">crt_h</span> <span class="op">+</span>
                              <span class="kw">university</span> <span class="op">+</span> <span class="kw">high_income</span>, data=<span class="kw">.</span>)
</pre></div>
<p>Now, outputting these regressions to a table.</p>
<div class="sourceCode" id="cb61"><pre class="downlit">
<span class="fu">stargazer</span>(<span class="kw">cineq_1</span>, <span class="kw">cineq_2</span>, <span class="kw">cineq_3</span>, <span class="kw">cnoth_1</span>, <span class="kw">cnoth_2</span>, <span class="kw">cnoth_3</span>,
          se = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">cineq_1</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_c</span>)))),
                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">cineq_2</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_c</span>)))),
                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">cineq_3</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_c</span>)))),
                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">cnoth_1</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_c</span>)))),
                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">cnoth_2</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_c</span>)))),
                    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fu">cluster.vcov</span>(<span class="kw">cnoth_3</span>, cluster=<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">df_c</span>))))),
         type=<span class="st">"text"</span>, style=<span class="st">"aer"</span>, df=<span class="fl">FALSE</span>, keep.stat=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"rsq"</span>,<span class="st">"n"</span>), 
         p.auto=<span class="fl">TRUE</span>,
         star.char=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>, <span class="st">""</span>,<span class="st">""</span>), notes=<span class="st">""</span>, notes.append=<span class="fl">FALSE</span>, report=<span class="st">"vcsp"</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; ========================================================================================</span>
<span class="co">#&gt;                                       inequality                 zero_to_worst_off      </span>
<span class="co">#&gt;                                 (1)       (2)       (3)       (4)       (5)       (6)   </span>
<span class="co">#&gt; ----------------------------------------------------------------------------------------</span>
<span class="co">#&gt; treatmentgroupForced Choice    0.129     0.131     0.130     0.093     0.095     0.094  </span>
<span class="co">#&gt;                               (0.013)   (0.013)   (0.013)   (0.012)   (0.012)   (0.012) </span>
<span class="co">#&gt;                              p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; treatmentgroupNominal Choice   0.117     0.115     0.114     0.071     0.070     0.070  </span>
<span class="co">#&gt;                               (0.014)   (0.014)   (0.014)   (0.013)   (0.013)   (0.013) </span>
<span class="co">#&gt;                              p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; leftp                                   -0.067    -0.063              -0.049    -0.045  </span>
<span class="co">#&gt;                                         (0.013)   (0.013)             (0.012)   (0.012) </span>
<span class="co">#&gt;                                        p = 0.000 p = 0.000           p = 0.000 p = 0.001</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; female                                  -0.087    -0.075              -0.049    -0.038  </span>
<span class="co">#&gt;                                         (0.012)   (0.012)             (0.011)   (0.011) </span>
<span class="co">#&gt;                                        p = 0.000 p = 0.000           p = 0.000 p = 0.001</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; age_h                                   -0.049    -0.048              -0.031    -0.031  </span>
<span class="co">#&gt;                                         (0.012)   (0.011)             (0.011)   (0.011) </span>
<span class="co">#&gt;                                        p = 0.000 p = 0.000           p = 0.005 p = 0.005</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; crt_h                                    0.059     0.054               0.051     0.045  </span>
<span class="co">#&gt;                                         (0.012)   (0.012)             (0.011)   (0.011) </span>
<span class="co">#&gt;                                        p = 0.000 p = 0.000           p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; university                                         0.008                         0.016  </span>
<span class="co">#&gt;                                                   (0.012)                       (0.011) </span>
<span class="co">#&gt;                                                  p = 0.501                     p = 0.151</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; high_income                                        0.056                         0.055  </span>
<span class="co">#&gt;                                                   (0.013)                       (0.013) </span>
<span class="co">#&gt;                                                  p = 0.000                     p = 0.000</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; Constant                       0.154     0.237     0.207     0.081     0.129     0.095  </span>
<span class="co">#&gt;                               (0.009)   (0.017)   (0.018)   (0.008)   (0.015)   (0.017) </span>
<span class="co">#&gt;                              p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000 p = 0.000</span>
<span class="co">#&gt;                                                                                         </span>
<span class="co">#&gt; Observations                   3,922     3,922     3,922     3,922     3,922     3,922  </span>
<span class="co">#&gt; R2                             0.023     0.062     0.067     0.013     0.033     0.040  </span>
<span class="co">#&gt; ----------------------------------------------------------------------------------------</span>
<span class="co">#&gt; Notes:</span>
</pre></div>
<p>Also to latex (silent):</p>
</div>
</div>
</div>
<div id="balance-table-appendix" class="section level1">
<h1 class="hasAnchor">
<a href="#balance-table-appendix" class="anchor"></a>Balance table (appendix)</h1>
<div class="sourceCode" id="cb62"><pre class="downlit">
<span class="kw">dfk_summary</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span>(<span class="kw">treatment</span>) <span class="op">%&gt;%</span> <span class="fu">summarize</span>(mean_age = <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw">age</span>), se_age = <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="kw">age</span>)<span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu">n</span>()),
                                                          mean_female = <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw">female</span>), se_female=<span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="kw">female</span>)<span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu">n</span>()),
                                                          mean_crt = <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw">crt</span>), se_crt = <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="kw">crt</span>)<span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu">n</span>()),
                                                          mean_left = <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw">leftp</span>), se_leftp=<span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="kw">leftp</span>)<span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu">n</span>()),
                                                          n= <span class="fu">n</span>())
<span class="co">#&gt; `summarise()` ungrouping output (override with `.groups` argument)</span>
<span class="kw">dfk_totals</span> <span class="op">&lt;-</span> <span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu">summarize</span>(mean_age = <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw">age</span>), se_age = <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="kw">age</span>)<span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu">n</span>()),
                                 mean_female = <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw">female</span>), se_female=<span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="kw">female</span>)<span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu">n</span>()),
                                 mean_crt = <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw">crt</span>), se_crt = <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="kw">crt</span>)<span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu">n</span>()),
                                 mean_left = <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw">leftp</span>), se_leftp=<span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="kw">leftp</span>)<span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fu">n</span>()),
                                 n= <span class="fu">n</span>())
</pre></div>
<p>Output of balance table</p>
<div class="sourceCode" id="cb63"><pre class="downlit">
<span class="kw">dfk_summary</span> <span class="op">%&gt;%</span> <span class="kw">knitr</span>::<span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(digits=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">0</span>))
</pre></div>
<table class="table">
<colgroup>
<col width="20%">
<col width="9%">
<col width="7%">
<col width="12%">
<col width="10%">
<col width="9%">
<col width="7%">
<col width="10%">
<col width="9%">
<col width="5%">
</colgroup>
<thead><tr class="header">
<th align="left">treatment</th>
<th align="right">mean_age</th>
<th align="right">se_age</th>
<th align="right">mean_female</th>
<th align="right">se_female</th>
<th align="right">mean_crt</th>
<th align="right">se_crt</th>
<th align="right">mean_left</th>
<th align="right">se_leftp</th>
<th align="right">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Base (w)</td>
<td align="right">49.7</td>
<td align="right">0.62</td>
<td align="right">0.49</td>
<td align="right">0.02</td>
<td align="right">1.33</td>
<td align="right">0.04</td>
<td align="right">0.69</td>
<td align="right">0.02</td>
<td align="right">745</td>
</tr>
<tr class="even">
<td align="left">Forced Choice (w)</td>
<td align="right">48.0</td>
<td align="right">0.37</td>
<td align="right">0.46</td>
<td align="right">0.01</td>
<td align="right">1.37</td>
<td align="right">0.02</td>
<td align="right">0.69</td>
<td align="right">0.01</td>
<td align="right">2123</td>
</tr>
<tr class="odd">
<td align="left">Nominal Choice (w)</td>
<td align="right">48.6</td>
<td align="right">0.63</td>
<td align="right">0.44</td>
<td align="right">0.02</td>
<td align="right">1.40</td>
<td align="right">0.04</td>
<td align="right">0.67</td>
<td align="right">0.02</td>
<td align="right">713</td>
</tr>
<tr class="even">
<td align="left">Base (nw)</td>
<td align="right">48.2</td>
<td align="right">0.63</td>
<td align="right">0.51</td>
<td align="right">0.02</td>
<td align="right">1.38</td>
<td align="right">0.04</td>
<td align="right">0.69</td>
<td align="right">0.02</td>
<td align="right">711</td>
</tr>
<tr class="odd">
<td align="left">Forced Choice (nw)</td>
<td align="right">48.1</td>
<td align="right">0.62</td>
<td align="right">0.46</td>
<td align="right">0.02</td>
<td align="right">1.40</td>
<td align="right">0.04</td>
<td align="right">0.70</td>
<td align="right">0.02</td>
<td align="right">741</td>
</tr>
<tr class="even">
<td align="left">Nominal Choice (nw)</td>
<td align="right">49.2</td>
<td align="right">0.63</td>
<td align="right">0.51</td>
<td align="right">0.02</td>
<td align="right">1.35</td>
<td align="right">0.04</td>
<td align="right">0.70</td>
<td align="right">0.02</td>
<td align="right">724</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb64"><pre class="downlit">
<span class="kw">dfk_totals</span> <span class="op">%&gt;%</span> <span class="kw">knitr</span>::<span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(digits=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">0</span>))
</pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">mean_age</th>
<th align="right">se_age</th>
<th align="right">mean_female</th>
<th align="right">se_female</th>
<th align="right">mean_crt</th>
<th align="right">se_crt</th>
<th align="right">mean_left</th>
<th align="right">se_leftp</th>
<th align="right">n</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">48.5</td>
<td align="right">0.22</td>
<td align="right">0.48</td>
<td align="right">0.01</td>
<td align="right">1.37</td>
<td align="right">0.02</td>
<td align="right">0.69</td>
<td align="right">0.01</td>
<td align="right">5757</td>
</tr></tbody>
</table>
<div id="balance-tests" class="section level2">
<h2 class="hasAnchor">
<a href="#balance-tests" class="anchor"></a>Balance tests</h2>
<div class="sourceCode" id="cb65"><pre class="downlit">
<span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">age</span> <span class="op">~</span> <span class="kw">treatment_org</span>, data=<span class="kw">.</span>) <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>()
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = age ~ treatment_org, data = .)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -31.720 -15.163   0.837  14.280  40.991 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;                                        Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)                             49.7201     0.6185  80.395   &lt;2e-16 ***</span>
<span class="co">#&gt; treatment_orgForced Choice (w)          -0.8341     0.8879  -0.939   0.3476    </span>
<span class="co">#&gt; treatment_orgNominal Choice (w)         -1.1121     0.8844  -1.258   0.2086    </span>
<span class="co">#&gt; treatment_orgBase (nw)                  -1.5570     0.8850  -1.759   0.0786 .  </span>
<span class="co">#&gt; treatment_orgForced Choice (nw)         -1.6304     0.8758  -1.862   0.0627 .  </span>
<span class="co">#&gt; treatment_orgNominal Choice (nw)        -0.5578     0.8809  -0.633   0.5266    </span>
<span class="co">#&gt; treatment_orgForced Choice strong       -2.0614     0.8828  -2.335   0.0196 *  </span>
<span class="co">#&gt; treatment_orgForced Choice very strong  -2.2109     0.8876  -2.491   0.0128 *  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 16.88 on 5749 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.001792,   Adjusted R-squared:  0.0005768 </span>
<span class="co">#&gt; F-statistic: 1.475 on 7 and 5749 DF,  p-value: 0.1713</span>
<span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">female</span> <span class="op">~</span> <span class="kw">treatment_org</span>, data=<span class="kw">.</span>) <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>()
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = female ~ treatment_org, data = .)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -0.5097 -0.4708 -0.4446  0.5292  0.5554 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;                                        Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)                             0.48859    0.01829  26.713   &lt;2e-16 ***</span>
<span class="co">#&gt; treatment_orgForced Choice (w)         -0.02848    0.02626  -1.084   0.2782    </span>
<span class="co">#&gt; treatment_orgNominal Choice (w)        -0.04399    0.02615  -1.682   0.0926 .  </span>
<span class="co">#&gt; treatment_orgBase (nw)                  0.02055    0.02617   0.785   0.4324    </span>
<span class="co">#&gt; treatment_orgForced Choice (nw)        -0.02840    0.02590  -1.097   0.2729    </span>
<span class="co">#&gt; treatment_orgNominal Choice (nw)        0.02108    0.02605   0.809   0.4185    </span>
<span class="co">#&gt; treatment_orgForced Choice strong      -0.02898    0.02611  -1.110   0.2670    </span>
<span class="co">#&gt; treatment_orgForced Choice very strong -0.01775    0.02625  -0.676   0.4989    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 0.4992 on 5749 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.002086,   Adjusted R-squared:  0.0008708 </span>
<span class="co">#&gt; F-statistic: 1.717 on 7 and 5749 DF,  p-value: 0.1003</span>
<span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">crt</span> <span class="op">~</span> <span class="kw">treatment_org</span>, data=<span class="kw">.</span>) <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>()
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = crt ~ treatment_org, data = .)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -1.4259 -1.3454 -0.3454  0.6658  1.6658 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;                                        Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)                             1.33423    0.04188  31.856   &lt;2e-16 ***</span>
<span class="co">#&gt; treatment_orgForced Choice (w)          0.09170    0.06013   1.525    0.127    </span>
<span class="co">#&gt; treatment_orgNominal Choice (w)         0.06409    0.05989   1.070    0.285    </span>
<span class="co">#&gt; treatment_orgBase (nw)                  0.04974    0.05994   0.830    0.407    </span>
<span class="co">#&gt; treatment_orgForced Choice (nw)         0.06928    0.05931   1.168    0.243    </span>
<span class="co">#&gt; treatment_orgNominal Choice (nw)        0.01522    0.05966   0.255    0.799    </span>
<span class="co">#&gt; treatment_orgForced Choice strong       0.01118    0.05979   0.187    0.852    </span>
<span class="co">#&gt; treatment_orgForced Choice very strong  0.01428    0.06011   0.238    0.812    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 1.143 on 5749 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.0007564,  Adjusted R-squared:  -0.0004603 </span>
<span class="co">#&gt; F-statistic: 0.6217 on 7 and 5749 DF,  p-value: 0.7384</span>
<span class="kw">df_k</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="kw">leftp</span> <span class="op">~</span> <span class="kw">treatment_org</span>, data=<span class="kw">.</span>) <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>()
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = leftp ~ treatment_org, data = .)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -0.7103 -0.6823  0.2983  0.3144  0.3254 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;                                          Estimate Std. Error t value Pr(&gt;|t|)</span>
<span class="co">#&gt; (Intercept)                             0.6859060  0.0169281  40.519   &lt;2e-16</span>
<span class="co">#&gt; treatment_orgForced Choice (w)         -0.0035699  0.0243037  -0.147    0.883</span>
<span class="co">#&gt; treatment_orgNominal Choice (w)        -0.0112917  0.0242070  -0.466    0.641</span>
<span class="co">#&gt; treatment_orgBase (nw)                  0.0004512  0.0242244   0.019    0.985</span>
<span class="co">#&gt; treatment_orgForced Choice (nw)         0.0185474  0.0239722   0.774    0.439</span>
<span class="co">#&gt; treatment_orgNominal Choice (nw)        0.0157514  0.0241129   0.653    0.514</span>
<span class="co">#&gt; treatment_orgForced Choice strong       0.0244004  0.0241639   1.010    0.313</span>
<span class="co">#&gt; treatment_orgForced Choice very strong -0.0002730  0.0242948  -0.011    0.991</span>
<span class="co">#&gt;                                           </span>
<span class="co">#&gt; (Intercept)                            ***</span>
<span class="co">#&gt; treatment_orgForced Choice (w)            </span>
<span class="co">#&gt; treatment_orgNominal Choice (w)           </span>
<span class="co">#&gt; treatment_orgBase (nw)                    </span>
<span class="co">#&gt; treatment_orgForced Choice (nw)           </span>
<span class="co">#&gt; treatment_orgNominal Choice (nw)          </span>
<span class="co">#&gt; treatment_orgForced Choice strong         </span>
<span class="co">#&gt; treatment_orgForced Choice very strong    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 0.462 on 5749 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.0006364,  Adjusted R-squared:  -0.0005805 </span>
<span class="co">#&gt; F-statistic: 0.523 on 7 and 5749 DF,  p-value: 0.8179</span>
</pre></div>
</div>
</div>
<div id="sessioninfo" class="section level1">
<h1 class="hasAnchor">
<a href="#sessioninfo" class="anchor"></a>sessionInfo()</h1>
<div class="sourceCode" id="cb66"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()
<span class="co">#&gt; R version 4.0.2 (2020-06-22)</span>
<span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span>
<span class="co">#&gt; Running under: Ubuntu 18.04.5 LTS</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Matrix products: default</span>
<span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas/libblas.so.3</span>
<span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/libopenblasp-r0.2.20.so</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; locale:</span>
<span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span>
<span class="co">#&gt;  [3] LC_TIME=nb_NO.UTF-8        LC_COLLATE=en_US.UTF-8    </span>
<span class="co">#&gt;  [5] LC_MONETARY=nb_NO.UTF-8    LC_MESSAGES=en_US.UTF-8   </span>
<span class="co">#&gt;  [7] LC_PAPER=nb_NO.UTF-8       LC_NAME=C                 </span>
<span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span>
<span class="co">#&gt; [11] LC_MEASUREMENT=nb_NO.UTF-8 LC_IDENTIFICATION=C       </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attached base packages:</span>
<span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; other attached packages:</span>
<span class="co">#&gt;  [1] here_0.1           multiwayvcov_1.2.3 multcomp_1.4-13    TH.data_1.0-10    </span>
<span class="co">#&gt;  [5] MASS_7.3-53        survival_3.1-12    mvtnorm_1.1-1      stargazer_5.2.2   </span>
<span class="co">#&gt;  [9] forcats_0.5.0      stringr_1.4.0      dplyr_1.0.2        purrr_0.3.4       </span>
<span class="co">#&gt; [13] readr_1.3.1        tidyr_1.1.2        tibble_3.0.3       ggplot2_3.3.2     </span>
<span class="co">#&gt; [17] tidyverse_1.3.0    mmbruteluck_0.1.9 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; loaded via a namespace (and not attached):</span>
<span class="co">#&gt;  [1] httr_1.4.2        jsonlite_1.7.1    splines_4.0.2     modelr_0.1.8     </span>
<span class="co">#&gt;  [5] assertthat_0.2.1  highr_0.8         blob_1.2.1        cellranger_1.1.0 </span>
<span class="co">#&gt;  [9] yaml_2.2.1        pillar_1.4.6      backports_1.1.10  lattice_0.20-41  </span>
<span class="co">#&gt; [13] glue_1.4.2        digest_0.6.25     rvest_0.3.6       colorspace_1.4-1 </span>
<span class="co">#&gt; [17] sandwich_2.5-1    htmltools_0.5.0   Matrix_1.2-18     pkgconfig_2.0.3  </span>
<span class="co">#&gt; [21] broom_0.7.0       haven_2.3.1       scales_1.1.1      cpp11_0.2.1      </span>
<span class="co">#&gt; [25] farver_2.0.3      generics_0.0.2    ellipsis_0.3.1    withr_2.2.0      </span>
<span class="co">#&gt; [29] cli_2.0.2         magrittr_1.5      crayon_1.3.4      readxl_1.3.1     </span>
<span class="co">#&gt; [33] memoise_1.1.0     evaluate_0.14     fs_1.5.0          fansi_0.4.1      </span>
<span class="co">#&gt; [37] xml2_1.3.2        tools_4.0.2       hms_0.5.3         lifecycle_0.2.0  </span>
<span class="co">#&gt; [41] munsell_0.5.0     reprex_0.3.0      compiler_4.0.2    pkgdown_1.6.1    </span>
<span class="co">#&gt; [45] systemfonts_0.3.1 rlang_0.4.7       grid_4.0.2        rstudioapi_0.11  </span>
<span class="co">#&gt; [49] labeling_0.3      rmarkdown_2.3     boot_1.3-25       gtable_0.3.0     </span>
<span class="co">#&gt; [53] codetools_0.2-16  DBI_1.1.0         R6_2.4.1          zoo_1.8-8        </span>
<span class="co">#&gt; [57] lubridate_1.7.9   knitr_1.29        utf8_1.1.4        rprojroot_1.3-2  </span>
<span class="co">#&gt; [61] ragg_0.3.1        desc_1.2.0        stringi_1.5.3     parallel_4.0.2   </span>
<span class="co">#&gt; [65] Rcpp_1.0.5        vctrs_0.3.4       dbplyr_1.4.4      tidyselect_1.1.0 </span>
<span class="co">#&gt; [69] xfun_0.17</span>
</pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Erik Ø. Sørensen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
